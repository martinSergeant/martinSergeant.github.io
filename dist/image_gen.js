!function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=10)}([function(t,e,i){"use strict";(function(t){i.d(e,"a",function(){return l}),i.d(e,"b",function(){return f});var r=i(1),n=i(2);let a=!1;try{navigator}catch(t){a=!0}const s=0,o=1,h=2;class l{static load(e,i){return new Promise(function(r,n){var s,o,h,l,f=new t,c=i.sendData,u=i.method||(c?"POST":"GET"),d=i.range,p=i.responseType,g=i.contentType,m=i.mimeType,b=i.headers,w=(!a&&(0==navigator.vendor.indexOf("Apple")&&/\sSafari\//.test(navigator.userAgent)),i.withCredentials);if(f.open(u,e),d){var y=d.size?d.start+d.size-1:"";f.setRequestHeader("Range","bytes="+d.start+"-"+y)}if(g&&f.setRequestHeader("Content-Type",g),m&&f.overrideMimeType(m),p&&(f.responseType=p),b)for(s=Object.keys(b),l=0;l<s.length;l++)h=b[o=s[l]],f.setRequestHeader(o,h);!0===w&&(f.withCredentials=!0),f.timeout=3e4,f.onload=function(t){0==f.status||f.status>=200&&f.status<=300?d&&206!=f.status?v("ERROR: range-byte header was ignored for url: "+e):r(f.response,f):416===f.status?v("Unsatisfiable range"):v("Error accessing resource: "+f.status)},f.onerror=function(t){v("Error accessing resource: "+e+" Status: "+f.status)},f.ontimeout=function(t){v("Timed out")},f.onabort=function(t){console.log("Aborted"),n(new igv.AbortLoad)};try{f.send(c)}catch(t){n(t)}function v(t){if(!n)throw Error(t);n(t)}})}static loadArrayBuffer(t,e){return void 0===e&&(e={}),e.responseType="arraybuffer",l.load(t,e)}static loadJson(t,e){return"POST"==(e.method||(e.sendData?"POST":"GET"))&&(e.contentType="application/json"),new Promise(function(i,r){l.load(t,e).then(function(t){i(t?JSON.parse(t):t)}).catch(r)})}static loadString(t,e){var i,r,n;return void 0===e&&(e={}),r=(n=t.indexOf("?"))>0?t.substring(0,n):t,(i=e.bgz?h:r.endsWith(".gz")?o:s)===s?(e.mimeType="text/plain; charset=x-user-defined",l.load(t,e)):(e.responseType="arraybuffer",new Promise(function(r,n){l.load(t,e).then(function(t){var e=l.arrayBufferToString(t,i);r(e)}).catch(n)}))}static loadStringFromFile(t,e){return new Promise(function(i,r){var n=new FileReader;e.range;n.onload=function(r){var a,f;a=e.bgz?h:t.name.endsWith(".gz")?o:s,f=l.arrayBufferToString(n.result,a),i(f,t)},n.onerror=function(e){console.log("reject uploading local file "+t.name),r(null,n)},n.readAsArrayBuffer(t)})}static isCrossDomain(t){var e=window.location.origin;return!t.startsWith(e)}static arrayBufferToString(t,e){for(var i,r="",a=0,s=(i=e===o?new n.a.Gunzip(new Uint8Array(t)).decompress():e===h?new Uint8Array(f(t)):new Uint8Array(t)).length;a<s;a++)r+=String.fromCharCode(i[a]);return r}}let f=function(t,e){var i=[],n=[0],a=0;for(e=e||t.byteLength-18;n[0]<e;){var s=new Uint8Array(t,n[0],18),o=s[11]<<8|s[10],h=(s[12],s[13],s[15],s[14],s[17]<<8|s[16]+1),l=12+o+n[0],f=t.byteLength-l;if(f<h+8)break;var c=Object(r.b)(t,l,f,n);n[0]+=8,a+=c.byteLength,i.push(c)}if(1==i.length)return i[0];for(var u=new Uint8Array(a),d=0,p=0;p<i.length;++p){var g=new Uint8Array(i[p]);Object(r.a)(g,0,u,d,g.length),d+=g.length}return u.buffer}}).call(this,i(5))},function(t,e,i){"use strict";i.d(e,"b",function(){return C}),i.d(e,"a",function(){return T});var r=15,n=1440,a=0,s=0,o=1,h=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],l=0,f=9,c=5,u=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],d=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],g=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],b=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function w(){}function y(){this.was=[0]}w.prototype.inflateInit=function(t,e){return t||(t=r),e&&(e=!1),this.istate=new y,this.istate.inflateInit(this,e?-t:t)},w.prototype.inflate=function(t){return null==this.istate?-2:this.istate.inflate(this,t)},w.prototype.inflateEnd=function(){if(null==this.istate)return-2;var t=istate.inflateEnd(this);return this.istate=null,t},w.prototype.inflateSync=function(){return istate.inflateSync(this)},w.prototype.inflateSetDictionary=function(t,e){return istate.inflateSetDictionary(this,t,e)},y.prototype.inflateReset=function(t){return null==t||null==t.istate?-2:(t.total_in=t.total_out=0,t.msg=null,t.istate.mode=0!=t.istate.nowrap?7:0,t.istate.blocks.reset(t,null),s)},y.prototype.inflateEnd=function(t){return null!=this.blocks&&this.blocks.free(t),this.blocks=null,s},y.prototype.inflateInit=function(t,e){t.msg=null,this.blocks=null;let i=0;return e<0&&(e=-e,i=1),e<8||e>15?(this.inflateEnd(t),-2):(this.wbits=e,t.istate.blocks=new _(t,0!=t.istate.nowrap?null:this,1<<e),this.inflateReset(t),s)},y.prototype.inflate=function(t,e){var i,r;if(null==t||null==t.istate||null==t.next_in)return-2;for(e=4==e?-5:s,i=-5;;)switch(t.istate.mode){case 0:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,8!=(15&(t.istate.method=t.next_in[t.next_in_index++]))){t.istate.mode=13,t.msg="unknown compression method",t.istate.marker=5;break}if(8+(t.istate.method>>4)>t.istate.wbits){t.istate.mode=13,t.msg="invalid window size",t.istate.marker=5;break}t.istate.mode=1;case 1:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,r=255&t.next_in[t.next_in_index++],((t.istate.method<<8)+r)%31!=0){t.istate.mode=13,t.msg="incorrect header check",t.istate.marker=5;break}if(0==(32&r)){t.istate.mode=7;break}t.istate.mode=2;case 2:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need=(255&t.next_in[t.next_in_index++])<<24&4278190080,t.istate.mode=3;case 3:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<16&16711680,t.istate.mode=4;case 4:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<8&65280,t.istate.mode=5;case 5:return 0==t.avail_in?i:(i=e,t.avail_in--,t.total_in++,t.istate.need+=255&t.next_in[t.next_in_index++],t.adler=t.istate.need,t.istate.mode=6,2);case 6:return t.istate.mode=13,t.msg="need dictionary",t.istate.marker=0,-2;case 7:if(-3==(i=t.istate.blocks.proc(t,i))){t.istate.mode=13,t.istate.marker=0;break}if(i==s&&(i=e),i!=o)return i;if(i=e,t.istate.blocks.reset(t,t.istate.was),0!=t.istate.nowrap){t.istate.mode=12;break}t.istate.mode=8;case 8:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need=(255&t.next_in[t.next_in_index++])<<24&4278190080,t.istate.mode=9;case 9:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<16&16711680,t.istate.mode=10;case 10:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<8&65280,t.istate.mode=11;case 11:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,t.istate.need+=255&t.next_in[t.next_in_index++],t.istate.was[0]!=t.istate.need){t.istate.mode=13,t.msg="incorrect data check",t.istate.marker=5;break}t.istate.mode=12;case 12:return o;case 13:return-3;default:return-2}},y.prototype.inflateSetDictionary=function(t,e,i){var r=0,n=i;return null==t||null==t.istate||6!=t.istate.mode?-2:t._adler.adler32(1,e,0,i)!=t.adler?-3:(t.adler=t._adler.adler32(0,null,0,0),n>=1<<t.istate.wbits&&(r=i-(n=(1<<t.istate.wbits)-1)),t.istate.blocks.set_dictionary(e,r,n),t.istate.mode=7,s)};var v=[0,0,255,255];y.prototype.inflateSync=function(t){var e,i,r,n,a;if(null==t||null==t.istate)return-2;if(13!=t.istate.mode&&(t.istate.mode=13,t.istate.marker=0),0==(e=t.avail_in))return-5;for(i=t.next_in_index,r=t.istate.marker;0!=e&&r<4;)t.next_in[i]==v[r]?r++:r=0!=t.next_in[i]?0:4-r,i++,e--;return t.total_in+=i-t.next_in_index,t.next_in_index=i,t.avail_in=e,t.istate.marker=r,4!=r?-3:(n=t.total_in,a=t.total_out,this.inflateReset(t),t.total_in=n,t.total_out=a,t.istate.mode=7,s)},y.prototype.inflateSyncPoint=function(t){return null==t||null==t.istate||null==t.istate.blocks?-2:t.istate.blocks.sync_point()};var x=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function _(t,e,i){this.hufts=new Int32Array(3*n),this.window=new Uint8Array(i),this.end=i,this.checkfn=e,this.mode=l,this.reset(t,null),this.left=0,this.table=0,this.index=0,this.blens=null,this.bb=new Int32Array(1),this.tb=new Int32Array(1),this.codes=new k,this.last=0,this.bitk=0,this.bitb=0,this.read=0,this.write=0,this.check=0,this.inftree=new S}_.prototype.reset=function(t,e){e&&(e[0]=this.check),6==this.mode&&this.codes.free(t),this.mode=l,this.bitk=0,this.bitb=0,this.read=this.write=0,this.checkfn&&(t.adler=this.check=t._adler.adler32(0,null,0,0))},_.prototype.proc=function(t,e){var i,r,n,a,f,c,u;for(a=t.next_in_index,f=t.avail_in,r=this.bitb,n=this.bitk,u=(c=this.write)<this.read?this.read-c-1:this.end-c;;)switch(this.mode){case l:for(;n<3;){if(0==f)return this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);e=s,f--,r|=(255&t.next_in[a++])<<n,n+=8}switch(i=7&r,this.last=1&i,i>>>1){case 0:r>>>=3,r>>>=i=7&(n-=3),n-=i,this.mode=1;break;case 1:I(m=new Int32Array(1),b=new Int32Array(1),w=[],y=[],t),this.codes.init(m[0],b[0],w[0],0,y[0],0,t),r>>>=3,n-=3,this.mode=6;break;case 2:r>>>=3,n-=3,this.mode=3;break;case 3:return r>>>=3,n-=3,this.mode=13,t.msg="invalid block type",e=-3,this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e)}break;case 1:for(;n<32;){if(0==f)return this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);e=s,f--,r|=(255&t.next_in[a++])<<n,n+=8}if((~r>>>16&65535)!=(65535&r))return this.mode=13,t.msg="invalid stored block lengths",e=-3,this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);this.left=65535&r,r=n=0,this.mode=0!=left?2:0!=this.last?7:l;break;case 2:if(0==f)return this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,write=c,this.inflate_flush(t,e);if(0==u&&(c==end&&0!=read&&(u=(c=0)<this.read?this.read-c-1:this.end-c),0==u&&(this.write=c,e=this.inflate_flush(t,e),u=(c=this.write)<this.read?this.read-c-1:this.end-c,c==this.end&&0!=this.read&&(u=(c=0)<this.read?this.read-c-1:this.end-c),0==u)))return this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);if(e=s,(i=this.left)>f&&(i=f),i>u&&(i=u),T(t.next_in,a,window,c,i),a+=i,f-=i,c+=i,u-=i,0!=(this.left-=i))break;this.mode=0!=this.last?7:l;break;case 3:for(;n<14;){if(0==f)return this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);e=s,f--,r|=(255&t.next_in[a++])<<n,n+=8}if(this.table=i=16383&r,(31&i)>29||(i>>5&31)>29)return this.mode=9,t.msg="too many length or distance symbols",e=-3,this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);if(i=258+(31&i)+(i>>5&31),null==this.blens||this.blens.length<i)this.blens=new Int32Array(i);else for(var d=0;d<i;d++)this.blens[d]=0;r>>>=14,n-=14,this.index=0,this.mode=4;case 4:for(;this.index<4+(this.table>>>10);){for(;n<3;){if(0==f)return this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);e=s,f--,r|=(255&t.next_in[a++])<<n,n+=8}this.blens[x[this.index++]]=7&r,r>>>=3,n-=3}for(;this.index<19;)this.blens[x[this.index++]]=0;if(this.bb[0]=7,(i=this.inftree.inflate_trees_bits(this.blens,this.bb,this.tb,this.hufts,t))!=s)return-3==(e=i)&&(this.blens=null,this.mode=9),this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,write=c,this.inflate_flush(t,e);this.index=0,this.mode=5;case 5:for(;i=this.table,this.index<258+(31&i)+(i>>5&31);){var p,g;for(i=this.bb[0];n<i;){if(0==f)return this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);e=s,f--,r|=(255&t.next_in[a++])<<n,n+=8}if(i=this.hufts[3*(this.tb[0]+(r&h[i]))+1],(g=this.hufts[3*(this.tb[0]+(r&h[i]))+2])<16)r>>>=i,n-=i,this.blens[this.index++]=g;else{for(d=18==g?7:g-14,p=18==g?11:3;n<i+d;){if(0==f)return this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);e=s,f--,r|=(255&t.next_in[a++])<<n,n+=8}if(n-=i,p+=(r>>>=i)&h[d],r>>>=d,n-=d,(d=this.index)+p>258+(31&(i=this.table))+(i>>5&31)||16==g&&d<1)return this.blens=null,this.mode=9,t.msg="invalid bit length repeat",e=-3,this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);g=16==g?this.blens[d-1]:0;do{this.blens[d++]=g}while(0!=--p);this.index=d}}this.tb[0]=-1;var m=new Int32Array(1),b=new Int32Array(1),w=new Int32Array(1),y=new Int32Array(1);if(m[0]=9,b[0]=6,i=this.table,(i=this.inftree.inflate_trees_dynamic(257+(31&i),1+(i>>5&31),this.blens,m,b,w,y,this.hufts,t))!=s)return-3==i&&(this.blens=null,this.mode=13),e=i,this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);this.codes.init(m[0],b[0],this.hufts,w[0],this.hufts,y[0],t),this.mode=6;case 6:if(this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,(e=this.codes.proc(this,t,e))!=o)return this.inflate_flush(t,e);if(e=s,this.codes.free(t),a=t.next_in_index,f=t.avail_in,r=this.bitb,n=this.bitk,u=(c=this.write)<this.read?this.read-c-1:this.end-c,0==this.last){this.mode=l;break}this.mode=7;case 7:if(this.write=c,e=this.inflate_flush(t,e),u=(c=this.write)<this.read?this.read-c-1:this.end-c,this.read!=this.write)return this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);this.mode=12;case 8:return e=o,this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);case 9:return e=-3,this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e);default:return e=-2,this.bitb=r,this.bitk=n,t.avail_in=f,t.total_in+=a-t.next_in_index,t.next_in_index=a,this.write=c,this.inflate_flush(t,e)}},_.prototype.free=function(t){this.reset(t,null),this.window=null,this.hufts=null},_.prototype.set_dictionary=function(t,e,i){T(t,e,window,0,i),this.read=this.write=i},_.prototype.sync_point=function(){return 1==this.mode},_.prototype.inflate_flush=function(t,e){var i,r,n;return r=t.next_out_index,(i=((n=this.read)<=this.write?this.write:this.end)-n)>t.avail_out&&(i=t.avail_out),0!=i&&-5==e&&(e=s),t.avail_out-=i,t.total_out+=i,null!=this.checkfn&&(t.adler=this.check=t._adler.adler32(this.check,this.window,n,i)),T(this.window,n,t.next_out,r,i),r+=i,(n+=i)==this.end&&(n=0,this.write==this.end&&(this.write=0),(i=this.write-n)>t.avail_out&&(i=t.avail_out),0!=i&&-5==e&&(e=s),t.avail_out-=i,t.total_out+=i,null!=this.checkfn&&(t.adler=this.check=t._adler.adler32(this.check,this.window,n,i)),T(this.window,n,t.next_out,r,i),r+=i,n+=i),t.next_out_index=r,this.read=n,e};function k(){}function S(){}function I(t,e,i,r,n){return t[0]=f,e[0]=c,i[0]=u,r[0]=d,s}k.prototype.init=function(t,e,i,r,n,a,s){this.mode=0,this.lbits=t,this.dbits=e,this.ltree=i,this.ltree_index=r,this.dtree=n,this.dtree_index=a,this.tree=null},k.prototype.proc=function(t,e,i){var r,n,a,l,f,c,u,d=0,p=0,g=0;for(g=e.next_in_index,l=e.avail_in,d=t.bitb,p=t.bitk,c=(f=t.write)<t.read?t.read-f-1:t.end-f;;)switch(this.mode){case 0:if(c>=258&&l>=10&&(t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,i=this.inflate_fast(this.lbits,this.dbits,this.ltree,this.ltree_index,this.dtree,this.dtree_index,t,e),g=e.next_in_index,l=e.avail_in,d=t.bitb,p=t.bitk,c=(f=t.write)<t.read?t.read-f-1:t.end-f,i!=s)){this.mode=i==o?7:9;break}this.need=this.lbits,this.tree=this.ltree,this.tree_index=this.ltree_index,this.mode=1;case 1:for(r=this.need;p<r;){if(0==l)return t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,t.inflate_flush(e,i);i=s,l--,d|=(255&e.next_in[g++])<<p,p+=8}if(n=3*(this.tree_index+(d&h[r])),d>>>=this.tree[n+1],p-=this.tree[n+1],0==(a=this.tree[n])){this.lit=this.tree[n+2],this.mode=6;break}if(0!=(16&a)){this.get=15&a,this.len=this.tree[n+2],this.mode=2;break}if(0==(64&a)){this.need=a,this.tree_index=n/3+this.tree[n+2];break}if(0!=(32&a)){this.mode=7;break}return this.mode=9,e.msg="invalid literal/length code",i=-3,t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,t.inflate_flush(e,i);case 2:for(r=this.get;p<r;){if(0==l)return t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,t.inflate_flush(e,i);i=s,l--,d|=(255&e.next_in[g++])<<p,p+=8}this.len+=d&h[r],d>>=r,p-=r,this.need=this.dbits,this.tree=this.dtree,this.tree_index=this.dtree_index,this.mode=3;case 3:for(r=this.need;p<r;){if(0==l)return t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,t.inflate_flush(e,i);i=s,l--,d|=(255&e.next_in[g++])<<p,p+=8}if(n=3*(this.tree_index+(d&h[r])),d>>=this.tree[n+1],p-=this.tree[n+1],0!=(16&(a=this.tree[n]))){this.get=15&a,this.dist=this.tree[n+2],this.mode=4;break}if(0==(64&a)){this.need=a,this.tree_index=n/3+this.tree[n+2];break}return this.mode=9,e.msg="invalid distance code",i=-3,t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,t.inflate_flush(e,i);case 4:for(r=this.get;p<r;){if(0==l)return t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,t.inflate_flush(e,i);i=s,l--,d|=(255&e.next_in[g++])<<p,p+=8}this.dist+=d&h[r],d>>=r,p-=r,this.mode=5;case 5:for(u=f-this.dist;u<0;)u+=t.end;for(;0!=this.len;){if(0==c&&(f==t.end&&0!=t.read&&(c=(f=0)<t.read?t.read-f-1:t.end-f),0==c&&(t.write=f,i=t.inflate_flush(e,i),c=(f=t.write)<t.read?t.read-f-1:t.end-f,f==t.end&&0!=t.read&&(c=(f=0)<t.read?t.read-f-1:t.end-f),0==c)))return t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,t.inflate_flush(e,i);t.window[f++]=t.window[u++],c--,u==t.end&&(u=0),this.len--}this.mode=0;break;case 6:if(0==c&&(f==t.end&&0!=t.read&&(c=(f=0)<t.read?t.read-f-1:t.end-f),0==c&&(t.write=f,i=t.inflate_flush(e,i),c=(f=t.write)<t.read?t.read-f-1:t.end-f,f==t.end&&0!=t.read&&(c=(f=0)<t.read?t.read-f-1:t.end-f),0==c)))return t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,t.inflate_flush(e,i);i=s,t.window[f++]=this.lit,c--,this.mode=0;break;case 7:if(p>7&&(p-=8,l++,g--),t.write=f,i=t.inflate_flush(e,i),c=(f=t.write)<t.read?t.read-f-1:t.end-f,t.read!=t.write)return t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,t.inflate_flush(e,i);this.mode=8;case 8:return i=o,t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,t.inflate_flush(e,i);case 9:return i=-3,t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,t.inflate_flush(e,i);default:return i=-2,t.bitb=d,t.bitk=p,e.avail_in=l,e.total_in+=g-e.next_in_index,e.next_in_index=g,t.write=f,t.inflate_flush(e,i)}},k.prototype.free=function(t){},k.prototype.inflate_fast=function(t,e,i,r,n,a,l,f){var c,u,d,p,g,m,b,w,y,v,x,_,k,S,I,A;b=f.next_in_index,w=f.avail_in,g=l.bitb,m=l.bitk,v=(y=l.write)<l.read?l.read-y-1:l.end-y,x=h[t],_=h[e];do{for(;m<20;)w--,g|=(255&f.next_in[b++])<<m,m+=8;if(0!=(p=(u=i)[A=3*((d=r)+(c=g&x))]))for(;;){if(g>>=u[A+1],m-=u[A+1],0!=(16&p)){for(p&=15,k=u[A+2]+(g&h[p]),g>>=p,m-=p;m<15;)w--,g|=(255&f.next_in[b++])<<m,m+=8;for(p=(u=n)[A=3*((d=a)+(c=g&_))];;){if(g>>=u[A+1],m-=u[A+1],0!=(16&p)){for(p&=15;m<p;)w--,g|=(255&f.next_in[b++])<<m,m+=8;if(S=u[A+2]+(g&h[p]),g>>=p,m-=p,v-=k,y>=S)I=y-S,l.window[y++]=l.window[I++],l.window[y++]=l.window[I++],k-=2;else{I=y-S;do{I+=l.end}while(I<0);if(k>(p=l.end-I)){if(k-=p,y-I>0&&p>y-I)do{l.window[y++]=l.window[I++]}while(0!=--p);else T(l.window,I,l.window,y,p),y+=p,I+=p,p=0;I=0}}do{l.window[y++]=l.window[I++]}while(0!=--k);break}if(0!=(64&p))return f.msg="invalid distance code",w+=k=m>>3<(k=f.avail_in-w)?m>>3:k,b-=k,m-=k<<3,l.bitb=g,l.bitk=m,f.avail_in=w,f.total_in+=b-f.next_in_index,f.next_in_index=b,l.write=y,-3;c+=u[A+2],p=u[A=3*(d+(c+=g&h[p]))]}break}if(0!=(64&p))return 0!=(32&p)?(w+=k=m>>3<(k=f.avail_in-w)?m>>3:k,b-=k,m-=k<<3,l.bitb=g,l.bitk=m,f.avail_in=w,f.total_in+=b-f.next_in_index,f.next_in_index=b,l.write=y,o):(f.msg="invalid literal/length code",w+=k=m>>3<(k=f.avail_in-w)?m>>3:k,b-=k,m-=k<<3,l.bitb=g,l.bitk=m,f.avail_in=w,f.total_in+=b-f.next_in_index,f.next_in_index=b,l.write=y,-3);if(c+=u[A+2],0==(p=u[A=3*(d+(c+=g&h[p]))])){g>>=u[A+1],m-=u[A+1],l.window[y++]=u[A+2],v--;break}}else g>>=u[A+1],m-=u[A+1],l.window[y++]=u[A+2],v--}while(v>=258&&w>=10);return w+=k=m>>3<(k=f.avail_in-w)?m>>3:k,b-=k,m-=k<<3,l.bitb=g,l.bitk=m,f.avail_in=w,f.total_in+=b-f.next_in_index,f.next_in_index=b,l.write=y,s},S.prototype.huft_build=function(t,e,i,r,a,o,h,l,f,c,u){var d,p,g,m,b,w,y,v,x,_,k,S,I,A,R;_=0,b=i;do{this.c[t[e+_]]++,_++,b--}while(0!=b);if(this.c[0]==i)return h[0]=-1,l[0]=0,s;for(v=l[0],w=1;w<=15&&0==this.c[w];w++);for(y=w,v<w&&(v=w),b=15;0!=b&&0==this.c[b];b--);for(g=b,v>b&&(v=b),l[0]=v,A=1<<w;w<b;w++,A<<=1)if((A-=this.c[w])<0)return-3;if((A-=this.c[b])<0)return-3;for(this.c[b]+=A,this.x[1]=w=0,_=1,I=2;0!=--b;)this.x[I]=w+=this.c[_],I++,_++;b=0,_=0;do{0!=(w=t[e+_])&&(this.v[this.x[w]++]=b),_++}while(++b<i);for(i=this.x[g],this.x[0]=b=0,_=0,m=-1,S=-v,this.u[0]=0,k=0,R=0;y<=g;y++)for(d=this.c[y];0!=d--;){for(;y>S+v;){if(m++,R=(R=g-(S+=v))>v?v:R,(p=1<<(w=y-S))>d+1&&(p-=d+1,I=y,w<R))for(;++w<R&&!((p<<=1)<=this.c[++I]);)p-=this.c[I];if(R=1<<w,this.hn[0]+R>n)return-3;this.u[m]=k=this.hn[0],this.hn[0]+=R,0!=m?(this.x[m]=b,this.r[0]=w,this.r[1]=v,w=b>>>S-v,this.r[2]=k-this.u[m-1]-w,T(this.r,0,f,3*(this.u[m-1]+w),3)):h[0]=k}for(this.r[1]=y-S,_>=i?this.r[0]=192:u[_]<r?(this.r[0]=this.v[_]<256?0:96,this.r[2]=this.v[_++]):(this.r[0]=o[this.v[_]-r]+16+64,this.r[2]=a[this.v[_++]-r]),p=1<<y-S,w=b>>>S;w<R;w+=p)T(this.r,0,f,3*(k+w),3);for(w=1<<y-1;0!=(b&w);w>>>=1)b^=w;for(b^=w,x=(1<<S)-1;(b&x)!=this.x[m];)m--,x=(1<<(S-=v))-1}return 0!=A&&1!=g?-5:s},S.prototype.inflate_trees_bits=function(t,e,i,r,n){var a;return this.initWorkArea(19),this.hn[0]=0,-3==(a=this.huft_build(t,0,19,19,null,null,i,e,r,this.hn,this.v))?n.msg="oversubscribed dynamic bit lengths tree":-5!=a&&0!=e[0]||(n.msg="incomplete dynamic bit lengths tree",a=-3),a},S.prototype.inflate_trees_dynamic=function(t,e,i,r,n,a,o,h,l){var f;return this.initWorkArea(288),this.hn[0]=0,(f=this.huft_build(i,0,t,257,p,g,a,r,h,this.hn,this.v))!=s||0==r[0]?(-3==f?l.msg="oversubscribed literal/length tree":-4!=f&&(l.msg="incomplete literal/length tree",f=-3),f):(this.initWorkArea(288),(f=this.huft_build(i,t,e,0,m,b,o,n,h,this.hn,this.v))!=s||0==n[0]&&t>257?(-3==f?l.msg="oversubscribed distance tree":-5==f?(l.msg="incomplete distance tree",f=-3):-4!=f&&(l.msg="empty distance tree with lengths",f=-3),f):s)},S.prototype.initWorkArea=function(t){null==this.hn&&(this.hn=new Int32Array(1),this.v=new Int32Array(t),this.c=new Int32Array(16),this.r=new Int32Array(3),this.u=new Int32Array(15),this.x=new Int32Array(16)),this.v.length<t&&(this.v=new Int32Array(t));for(var e=0;e<t;e++)this.v[e]=0;for(e=0;e<16;e++)this.c[e]=0;for(e=0;e<3;e++)this.r[e]=0;T(this.c,0,this.u,0,15),T(this.c,0,this.x,0,16)};var A="function"==typeof new Uint8Array(1).subarray;function T(t,e,i,r,n){if(0!=n){if(!t)throw"Undef src";if(!i)throw"Undef dest";0==e&&n==t.length?R(t,i,r):A?R(t.subarray(e,e+n),i,r):1==t.BYTES_PER_ELEMENT&&n>100?R(new Uint8Array(t.buffer,t.byteOffset+e,n),i,r):function(t,e,i,r,n){for(var a=0;a<n;++a)i[r+a]=t[e+a]}(t,e,i,r,n)}}function R(t,e,i){e.set(t,i)}function C(t,e,i,n){t=e?new Uint8Array(t,e,i):new Uint8Array(t);var h=new w;h.inflateInit(r,!0),h.next_in=t,h.next_in_index=0,h.avail_in=t.length;for(var l=[],f=0;;){var c=new Uint8Array(32e3);h.next_out=c,h.next_out_index=0,h.avail_out=c.length;var u=h.inflate(a);if(u!=s&&u!=o)throw h.msg;if(0!=h.avail_out){var d=new Uint8Array(c.length-h.avail_out);T(c,0,d,0,c.length-h.avail_out),c=d}if(l.push(c),f+=c.length,u==o)break}if(n&&(n[0]=(e||0)+h.next_in_index),1==l.length)return l[0].buffer;for(var p=new Uint8Array(f),g=0,m=0;m<l.length;++m){var b=l[m];T(b,0,p,g,b.length),g+=b.length}return p.buffer}},function(t,e,i){"use strict";i.d(e,"a",function(){return n});var r=!0;var n={Huffman:{},Util:{},CRC32:{},CompressionMethod:{DEFLATE:8,RESERVED:15},Zip:function(t){t=t||{},this.files=[],this.comment=t.comment,this.password}};n.Zip.CompressionMethod={STORE:0,DEFLATE:8},n.Zip.OperatingSystem={MSDOS:0,UNIX:3,MACINTOSH:7},n.Zip.Flags={ENCRYPT:1,DESCRIPTOR:8,UTF8:2048},n.Zip.FileHeaderSignature=[80,75,1,2],n.Zip.LocalFileHeaderSignature=[80,75,3,4],n.Zip.CentralDirectorySignature=[80,75,5,6],n.Zip.prototype.addFile=function(t,e){(e=e||{}).filename;var i,a=t.length,s=0;if(r&&t instanceof Array&&(t=new Uint8Array(t)),"number"!=typeof e.compressionMethod&&(e.compressionMethod=n.Zip.CompressionMethod.DEFLATE),e.compress)switch(e.compressionMethod){case n.Zip.CompressionMethod.STORE:break;case n.Zip.CompressionMethod.DEFLATE:s=n.CRC32.calc(t),t=this.deflateWithOption(t,e),i=!0;break;default:throw new Error("unknown compression method:"+e.compressionMethod)}this.files.push({buffer:t,option:e,compressed:i,encrypted:!1,size:a,crc32:s})},n.Zip.prototype.setPassword=function(t){this.password=t},n.Zip.prototype.compress=function(){var t,e,i,a,s,o,h,l,f,c,u,d,p,g,m,b,w,y,v,x,_,k,S,I,A,T,R,C=this.files,L=0,D=0;for(I=0,A=C.length;I<A;++I){if(m=(t=C[I]).option.filename?t.option.filename.length:0,b=t.option.extraField?t.option.extraField.length:0,w=t.option.comment?t.option.comment.length:0,!t.compressed)switch(t.crc32=n.CRC32.calc(t.buffer),t.option.compressionMethod){case n.Zip.CompressionMethod.STORE:break;case n.Zip.CompressionMethod.DEFLATE:t.buffer=this.deflateWithOption(t.buffer,t.option),t.compressed=!0;break;default:throw new Error("unknown compression method:"+t.option.compressionMethod)}if(void 0!==t.option.password||void 0!==this.password){for(S=this.createEncryptionKey(t.option.password||this.password),_=t.buffer,r?((k=new Uint8Array(_.length+12)).set(_,12),_=k):_.unshift(0,0,0,0,0,0,0,0,0,0,0,0),T=0;T<12;++T)_[T]=this.encode(S,11===I?255&t.crc32:256*Math.random()|0);for(R=_.length;T<R;++T)_[T]=this.encode(S,_[T]);t.buffer=_}L+=30+m+t.buffer.length,D+=46+m+w}for(o=22+(this.comment?this.comment.length:0),e=new(r?Uint8Array:Array)(L+D+o),i=0,s=(a=L)+D,I=0,A=C.length;I<A;++I){if(m=(t=C[I]).option.filename?t.option.filename.length:0,b=0,w=t.option.comment?t.option.comment.length:0,h=i,e[i++]=n.Zip.LocalFileHeaderSignature[0],e[i++]=n.Zip.LocalFileHeaderSignature[1],e[i++]=n.Zip.LocalFileHeaderSignature[2],e[i++]=n.Zip.LocalFileHeaderSignature[3],e[a++]=n.Zip.FileHeaderSignature[0],e[a++]=n.Zip.FileHeaderSignature[1],e[a++]=n.Zip.FileHeaderSignature[2],e[a++]=n.Zip.FileHeaderSignature[3],l=20,e[a++]=255&l,e[a++]=t.option.os||n.Zip.OperatingSystem.MSDOS,e[i++]=e[a++]=255&l,e[i++]=e[a++]=l>>8&255,f=0,(t.option.password||this.password)&&(f|=n.Zip.Flags.ENCRYPT),e[i++]=e[a++]=255&f,e[i++]=e[a++]=f>>8&255,c=t.option.compressionMethod,e[i++]=e[a++]=255&c,e[i++]=e[a++]=c>>8&255,u=t.option.date||new Date,e[i++]=e[a++]=(7&u.getMinutes())<<5|u.getSeconds()/2|0,e[i++]=e[a++]=u.getHours()<<3|u.getMinutes()>>3,e[i++]=e[a++]=(u.getMonth()+1&7)<<5|u.getDate(),e[i++]=e[a++]=(u.getFullYear()-1980&127)<<1|u.getMonth()+1>>3,d=t.crc32,e[i++]=e[a++]=255&d,e[i++]=e[a++]=d>>8&255,e[i++]=e[a++]=d>>16&255,e[i++]=e[a++]=d>>24&255,p=t.buffer.length,e[i++]=e[a++]=255&p,e[i++]=e[a++]=p>>8&255,e[i++]=e[a++]=p>>16&255,e[i++]=e[a++]=p>>24&255,g=t.size,e[i++]=e[a++]=255&g,e[i++]=e[a++]=g>>8&255,e[i++]=e[a++]=g>>16&255,e[i++]=e[a++]=g>>24&255,e[i++]=e[a++]=255&m,e[i++]=e[a++]=m>>8&255,e[i++]=e[a++]=255&b,e[i++]=e[a++]=b>>8&255,e[a++]=255&w,e[a++]=w>>8&255,e[a++]=0,e[a++]=0,e[a++]=0,e[a++]=0,e[a++]=0,e[a++]=0,e[a++]=0,e[a++]=0,e[a++]=255&h,e[a++]=h>>8&255,e[a++]=h>>16&255,e[a++]=h>>24&255,y=t.option.filename)if(r)e.set(y,i),e.set(y,a),i+=m,a+=m;else for(T=0;T<m;++T)e[i++]=e[a++]=y[T];if(v=t.option.extraField)if(r)e.set(v,i),e.set(v,a),i+=b,a+=b;else for(T=0;T<w;++T)e[i++]=e[a++]=v[T];if(x=t.option.comment)if(r)e.set(x,a),a+=w;else for(T=0;T<w;++T)e[a++]=x[T];if(r)e.set(t.buffer,i),i+=t.buffer.length;else for(T=0,R=t.buffer.length;T<R;++T)e[i++]=t.buffer[T]}if(e[s++]=n.Zip.CentralDirectorySignature[0],e[s++]=n.Zip.CentralDirectorySignature[1],e[s++]=n.Zip.CentralDirectorySignature[2],e[s++]=n.Zip.CentralDirectorySignature[3],e[s++]=0,e[s++]=0,e[s++]=0,e[s++]=0,e[s++]=255&A,e[s++]=A>>8&255,e[s++]=255&A,e[s++]=A>>8&255,e[s++]=255&D,e[s++]=D>>8&255,e[s++]=D>>16&255,e[s++]=D>>24&255,e[s++]=255&L,e[s++]=L>>8&255,e[s++]=L>>16&255,e[s++]=L>>24&255,w=this.comment?this.comment.length:0,e[s++]=255&w,e[s++]=w>>8&255,this.comment)if(r)e.set(this.comment,s),s+=w;else for(T=0,R=w;T<R;++T)e[s++]=this.comment[T];return e},n.Zip.prototype.deflateWithOption=function(t,e){return new n.RawDeflate(t,e.deflateOption).compress()},n.Zip.prototype.getByte=function(t){var e=65535&t[2]|2;return e*(1^e)>>8&255},n.Zip.prototype.encode=function(t,e){var i=this.getByte(t);return this.updateKeys(t,e),i^e},n.Zip.prototype.updateKeys=function(t,e){t[0]=n.CRC32.single(t[0],e),t[1]=1+(6681*(20173*(t[1]+(255&t[0]))>>>0)>>>0)>>>0,t[2]=n.CRC32.single(t[2],t[1]>>>24)},n.Zip.prototype.createEncryptionKey=function(t){var e,i,n=[305419896,591751049,878082192];for(r&&(n=new Uint32Array(n)),e=0,i=t.length;e<i;++e)this.updateKeys(n,255&t[e]);return n},n.Huffman.buildHuffmanTable=function(t){var e,i,n,a,s,o,h,l,f,c,u,d=t.length,p=0,g=Number.POSITIVE_INFINITY;for(l=0,f=d;l<f;++l)t[l]>p&&(p=t[l]),t[l]<g&&(g=t[l]);for(e=1<<p,i=new(r?Uint32Array:Array)(e),n=1,a=0,s=2;n<=p;){for(l=0;l<d;++l)if(t[l]===n){for(o=0,h=a,c=0;c<n;++c)o=o<<1|1&h,h>>=1;for(u=n<<16|l,c=o;c<e;c+=s)i[c]=u;++a}++n,a<<=1,s<<=1}return[i,p,g]};var a,s=n.Huffman.buildHuffmanTable;n.RawInflate=function(t,e){switch(this.buffer,this.blocks=[],this.bufferSize=32768,this.totalpos=0,this.ip=0,this.bitsbuf=0,this.bitsbuflen=0,this.input=r?new Uint8Array(t):t,this.output,this.op,this.bfinal=!1,this.bufferType=n.RawInflate.BufferType.ADAPTIVE,this.resize=!1,!e&&(e={})||(e.index&&(this.ip=e.index),e.bufferSize&&(this.bufferSize=e.bufferSize),e.bufferType&&(this.bufferType=e.bufferType),e.resize&&(this.resize=e.resize)),this.bufferType){case n.RawInflate.BufferType.BLOCK:this.op=n.RawInflate.MaxBackwardLength,this.output=new(r?Uint8Array:Array)(n.RawInflate.MaxBackwardLength+this.bufferSize+n.RawInflate.MaxCopyLength);break;case n.RawInflate.BufferType.ADAPTIVE:this.op=0,this.output=new(r?Uint8Array:Array)(this.bufferSize);break;default:throw new Error("invalid inflate mode")}},n.RawInflate.BufferType={BLOCK:0,ADAPTIVE:1},n.RawInflate.prototype.decompress=function(){for(;!this.bfinal;)this.parseBlock();switch(this.bufferType){case n.RawInflate.BufferType.BLOCK:return this.concatBufferBlock();case n.RawInflate.BufferType.ADAPTIVE:return this.concatBufferDynamic();default:throw new Error("invalid inflate mode")}},n.RawInflate.MaxBackwardLength=32768,n.RawInflate.MaxCopyLength=258,n.RawInflate.Order=(a=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],r?new Uint16Array(a):a),n.RawInflate.LengthCodeTable=function(t){return r?new Uint16Array(t):t}([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),n.RawInflate.LengthExtraTable=function(t){return r?new Uint8Array(t):t}([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),n.RawInflate.DistCodeTable=function(t){return r?new Uint16Array(t):t}([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),n.RawInflate.DistExtraTable=function(t){return r?new Uint8Array(t):t}([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),n.RawInflate.FixedLiteralLengthTable=function(){var t,e,i=new(r?Uint8Array:Array)(288);for(t=0,e=i.length;t<e;++t)i[t]=t<=143?8:t<=255?9:t<=279?7:8;return s(i)}(),n.RawInflate.FixedDistanceTable=function(){var t,e,i=new(r?Uint8Array:Array)(30);for(t=0,e=i.length;t<e;++t)i[t]=5;return s(i)}(),n.RawInflate.prototype.parseBlock=function(){var t=this.readBits(3);switch(1&t&&(this.bfinal=!0),t>>>=1){case 0:this.parseUncompressedBlock();break;case 1:this.parseFixedHuffmanBlock();break;case 2:this.parseDynamicHuffmanBlock();break;default:throw new Error("unknown BTYPE: "+t)}},n.RawInflate.prototype.readBits=function(t){var e,i=this.bitsbuf,r=this.bitsbuflen,n=this.input,a=this.ip;if(a+(t-r+7>>3)>=n.length)throw new Error("input buffer is broken");for(;r<t;)i|=n[a++]<<r,r+=8;return e=i&(1<<t)-1,i>>>=t,r-=t,this.bitsbuf=i,this.bitsbuflen=r,this.ip=a,e},n.RawInflate.prototype.readCodeByTable=function(t){for(var e,i,r=this.bitsbuf,n=this.bitsbuflen,a=this.input,s=this.ip,o=a.length,h=t[0],l=t[1];n<l&&!(s>=o);)r|=a[s++]<<n,n+=8;if((i=(e=h[r&(1<<l)-1])>>>16)>n)throw new Error("invalid code length: "+i);return this.bitsbuf=r>>i,this.bitsbuflen=n-i,this.ip=s,65535&e},n.RawInflate.prototype.parseUncompressedBlock=function(){var t,e,i=this.input,a=this.ip,s=this.output,o=this.op,h=i.length,l=s.length;if(this.bitsbuf=0,this.bitsbuflen=0,a+1>=h)throw new Error("invalid uncompressed block header: LEN");if(t=i[a++]|i[a++]<<8,a+1>=h)throw new Error("invalid uncompressed block header: NLEN");if(t===~(i[a++]|i[a++]<<8))throw new Error("invalid uncompressed block header: length verify");if(a+t>i.length)throw new Error("input buffer is broken");switch(this.bufferType){case n.RawInflate.BufferType.BLOCK:for(;o+t>s.length;){if(t-=e=l-o,r)s.set(i.subarray(a,a+e),o),o+=e,a+=e;else for(;e--;)s[o++]=i[a++];this.op=o,s=this.expandBufferBlock(),o=this.op}break;case n.RawInflate.BufferType.ADAPTIVE:for(;o+t>s.length;)s=this.expandBufferAdaptive({fixRatio:2});break;default:throw new Error("invalid inflate mode")}if(r)s.set(i.subarray(a,a+t),o),o+=t,a+=t;else for(;t--;)s[o++]=i[a++];this.ip=a,this.op=o,this.output=s},n.RawInflate.prototype.parseFixedHuffmanBlock=function(){switch(this.bufferType){case n.RawInflate.BufferType.ADAPTIVE:this.decodeHuffmanAdaptive(n.RawInflate.FixedLiteralLengthTable,n.RawInflate.FixedDistanceTable);break;case n.RawInflate.BufferType.BLOCK:this.decodeHuffmanBlock(n.RawInflate.FixedLiteralLengthTable,n.RawInflate.FixedDistanceTable);break;default:throw new Error("invalid inflate mode")}},n.RawInflate.prototype.parseDynamicHuffmanBlock=function(){var t,e,i,a,o,h,l,f,c,u=this.readBits(5)+257,d=this.readBits(5)+1,p=this.readBits(4)+4,g=new(r?Uint8Array:Array)(n.RawInflate.Order.length);for(f=0;f<p;++f)g[n.RawInflate.Order[f]]=this.readBits(3);if(!r)for(f=p,p=g.length;f<p;++f)g[n.RawInflate.Order[f]]=0;for(t=s(g),a=new(r?Uint8Array:Array)(u+d),f=0,c=u+d;f<c;)switch(o=this.readCodeByTable(t)){case 16:for(l=3+this.readBits(2);l--;)a[f++]=h;break;case 17:for(l=3+this.readBits(3);l--;)a[f++]=0;h=0;break;case 18:for(l=11+this.readBits(7);l--;)a[f++]=0;h=0;break;default:a[f++]=o,h=o}switch(e=s(r?a.subarray(0,u):a.slice(0,u)),i=s(r?a.subarray(u):a.slice(u)),this.bufferType){case n.RawInflate.BufferType.ADAPTIVE:this.decodeHuffmanAdaptive(e,i);break;case n.RawInflate.BufferType.BLOCK:this.decodeHuffmanBlock(e,i);break;default:throw new Error("invalid inflate mode")}},n.RawInflate.prototype.decodeHuffmanBlock=function(t,e){var i=this.output,r=this.op;this.currentLitlenTable=t;for(var a,s,o,h,l=i.length-n.RawInflate.MaxCopyLength,f=n.RawInflate.LengthCodeTable,c=n.RawInflate.LengthExtraTable,u=n.RawInflate.DistCodeTable,d=n.RawInflate.DistExtraTable;256!==(a=this.readCodeByTable(t));)if(a<256)r>=l&&(this.op=r,i=this.expandBufferBlock(),r=this.op),i[r++]=a;else for(h=f[s=a-257],c[s]>0&&(h+=this.readBits(c[s])),o=u[a=this.readCodeByTable(e)],d[a]>0&&(o+=this.readBits(d[a])),r>=l&&(this.op=r,i=this.expandBufferBlock(),r=this.op);h--;)i[r]=i[r++-o];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=r},n.RawInflate.prototype.decodeHuffmanAdaptive=function(t,e){var i=this.output,r=this.op;this.currentLitlenTable=t;for(var a,s,o,h,l=i.length,f=n.RawInflate.LengthCodeTable,c=n.RawInflate.LengthExtraTable,u=n.RawInflate.DistCodeTable,d=n.RawInflate.DistExtraTable;256!==(a=this.readCodeByTable(t));)if(a<256)r>=l&&(l=(i=this.expandBufferAdaptive()).length),i[r++]=a;else for(h=f[s=a-257],c[s]>0&&(h+=this.readBits(c[s])),o=u[a=this.readCodeByTable(e)],d[a]>0&&(o+=this.readBits(d[a])),r+h>l&&(l=(i=this.expandBufferAdaptive()).length);h--;)i[r]=i[r++-o];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=r},n.RawInflate.prototype.expandBufferBlock=function(t){var e,i,a=new(r?Uint8Array:Array)(this.op-n.RawInflate.MaxBackwardLength),s=this.op-n.RawInflate.MaxBackwardLength,o=this.output;if(r)a.set(o.subarray(n.RawInflate.MaxBackwardLength,a.length));else for(e=0,i=a.length;e<i;++e)a[e]=o[e+n.RawInflate.MaxBackwardLength];if(this.blocks.push(a),this.totalpos+=a.length,r)o.set(o.subarray(s,s+n.RawInflate.MaxBackwardLength));else for(e=0;e<n.RawInflate.MaxBackwardLength;++e)o[e]=o[s+e];return this.op=n.RawInflate.MaxBackwardLength,o},n.RawInflate.prototype.expandBufferAdaptive=function(t){var e,i,n,a=this.input.length/this.ip+1|0,s=this.input,o=this.output;return t&&("number"==typeof t.fixRatio&&(a=t.fixRatio),"number"==typeof t.addRatio&&(a+=t.addRatio)),i=a<2?(n=(s.length-this.ip)/this.currentLitlenTable[2]/2*258|0)<o.length?o.length+n:o.length<<1:o.length*a,r?(e=new Uint8Array(i)).set(o):e=o,this.output=e,this.output},n.RawInflate.prototype.concatBufferBlock=function(){var t,e,i,a,s,o=0,h=this.totalpos+(this.op-n.RawInflate.MaxBackwardLength),l=this.output,f=this.blocks,c=new(r?Uint8Array:Array)(h);if(0===f.length)return r?this.output.subarray(n.RawInflate.MaxBackwardLength,this.op):this.output.slice(n.RawInflate.MaxBackwardLength,this.op);for(e=0,i=f.length;e<i;++e)for(a=0,s=(t=f[e]).length;a<s;++a)c[o++]=t[a];for(e=n.RawInflate.MaxBackwardLength,i=this.op;e<i;++e)c[o++]=l[e];return this.blocks=[],this.buffer=c,this.buffer},n.RawInflate.prototype.concatBufferDynamic=function(){var t,e=this.op;return r?this.resize?(t=new Uint8Array(e)).set(this.output.subarray(0,e)):t=this.output.subarray(0,e):(this.output.length>e&&(this.output.length=e),t=this.output),this.buffer=t,this.buffer};s=n.Huffman.buildHuffmanTable;n.RawInflateStream=function(t,e,i){this.blocks=[],this.bufferSize=i||65e3,this.totalpos=0,this.ip=void 0===e?0:e,this.bitsbuf=0,this.bitsbuflen=0,this.input=r?new Uint8Array(t):t,this.output=new(r?Uint8Array:Array)(this.bufferSize),this.op=0,this.bfinal=!1,this.blockLength,this.resize=!1,this.litlenTable,this.distTable,this.sp=0,this.status=n.RawInflateStream.Status.INITIALIZED,this.ip_,this.bitsbuflen_,this.bitsbuf_},n.RawInflateStream.BlockType={UNCOMPRESSED:0,FIXED:1,DYNAMIC:2},n.RawInflateStream.Status={INITIALIZED:0,BLOCK_HEADER_START:1,BLOCK_HEADER_END:2,BLOCK_BODY_START:3,BLOCK_BODY_END:4,DECODE_BLOCK_START:5,DECODE_BLOCK_END:6},n.RawInflateStream.prototype.decompress=function(t,e){var i=!1;for(void 0!==t&&(this.input=t),void 0!==e&&(this.ip=e);!i;)switch(this.status){case n.RawInflateStream.Status.INITIALIZED:case n.RawInflateStream.Status.BLOCK_HEADER_START:this.readBlockHeader()<0&&(i=!0);break;case n.RawInflateStream.Status.BLOCK_HEADER_END:case n.RawInflateStream.Status.BLOCK_BODY_START:switch(this.currentBlockType){case n.RawInflateStream.BlockType.UNCOMPRESSED:this.readUncompressedBlockHeader()<0&&(i=!0);break;case n.RawInflateStream.BlockType.FIXED:this.parseFixedHuffmanBlock()<0&&(i=!0);break;case n.RawInflateStream.BlockType.DYNAMIC:this.parseDynamicHuffmanBlock()<0&&(i=!0)}break;case n.RawInflateStream.Status.BLOCK_BODY_END:case n.RawInflateStream.Status.DECODE_BLOCK_START:switch(this.currentBlockType){case n.RawInflateStream.BlockType.UNCOMPRESSED:this.parseUncompressedBlock()<0&&(i=!0);break;case n.RawInflateStream.BlockType.FIXED:case n.RawInflateStream.BlockType.DYNAMIC:this.decodeHuffman()<0&&(i=!0)}break;case n.RawInflateStream.Status.DECODE_BLOCK_END:this.bfinal?i=!0:this.status=n.RawInflateStream.Status.INITIALIZED}return this.concatBuffer()},n.RawInflateStream.MaxBackwardLength=32768,n.RawInflateStream.MaxCopyLength=258,n.RawInflateStream.Order=function(t){return r?new Uint16Array(t):t}([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),n.RawInflateStream.LengthCodeTable=function(t){return r?new Uint16Array(t):t}([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),n.RawInflateStream.LengthExtraTable=function(t){return r?new Uint8Array(t):t}([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),n.RawInflateStream.DistCodeTable=function(t){return r?new Uint16Array(t):t}([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),n.RawInflateStream.DistExtraTable=function(t){return r?new Uint8Array(t):t}([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),n.RawInflateStream.FixedLiteralLengthTable=function(){var t,e,i=new(r?Uint8Array:Array)(288);for(t=0,e=i.length;t<e;++t)i[t]=t<=143?8:t<=255?9:t<=279?7:8;return s(i)}(),n.RawInflateStream.FixedDistanceTable=function(){var t,e,i=new(r?Uint8Array:Array)(30);for(t=0,e=i.length;t<e;++t)i[t]=5;return s(i)}(),n.RawInflateStream.prototype.readBlockHeader=function(){var t;if(this.status=n.RawInflateStream.Status.BLOCK_HEADER_START,this.save_(),(t=this.readBits(3))<0)return this.restore_(),-1;switch(1&t&&(this.bfinal=!0),t>>>=1){case 0:this.currentBlockType=n.RawInflateStream.BlockType.UNCOMPRESSED;break;case 1:this.currentBlockType=n.RawInflateStream.BlockType.FIXED;break;case 2:this.currentBlockType=n.RawInflateStream.BlockType.DYNAMIC;break;default:throw new Error("unknown BTYPE: "+t)}this.status=n.RawInflateStream.Status.BLOCK_HEADER_END},n.RawInflateStream.prototype.readBits=function(t){for(var e,i=this.bitsbuf,r=this.bitsbuflen,n=this.input,a=this.ip;r<t;){if(n.length<=a)return-1;i|=(e=n[a++])<<r,r+=8}return e=i&(1<<t)-1,i>>>=t,r-=t,this.bitsbuf=i,this.bitsbuflen=r,this.ip=a,e},n.RawInflateStream.prototype.readCodeByTable=function(t){for(var e,i,r=this.bitsbuf,n=this.bitsbuflen,a=this.input,s=this.ip,o=t[0],h=t[1];n<h;){if(a.length<=s)return-1;r|=a[s++]<<n,n+=8}if((i=(e=o[r&(1<<h)-1])>>>16)>n)throw new Error("invalid code length: "+i);return this.bitsbuf=r>>i,this.bitsbuflen=n-i,this.ip=s,65535&e},n.RawInflateStream.prototype.readUncompressedBlockHeader=function(){var t,e=this.input,i=this.ip;if(this.status=n.RawInflateStream.Status.BLOCK_BODY_START,i+4>=e.length)return-1;if((t=e[i++]|e[i++]<<8)===~(e[i++]|e[i++]<<8))throw new Error("invalid uncompressed block header: length verify");this.bitsbuf=0,this.bitsbuflen=0,this.ip=i,this.blockLength=t,this.status=n.RawInflateStream.Status.BLOCK_BODY_END},n.RawInflateStream.prototype.parseUncompressedBlock=function(){var t=this.input,e=this.ip,i=this.output,r=this.op,a=this.blockLength;for(this.status=n.RawInflateStream.Status.DECODE_BLOCK_START;a--;){if(r===i.length&&(i=this.expandBuffer({fixRatio:2})),e>=t.length)return this.ip=e,this.op=r,this.blockLength=a+1,-1;i[r++]=t[e++]}return a<0&&(this.status=n.RawInflateStream.Status.DECODE_BLOCK_END),this.ip=e,this.op=r,0},n.RawInflateStream.prototype.parseFixedHuffmanBlock=function(){return this.status=n.RawInflateStream.Status.BLOCK_BODY_START,this.litlenTable=n.RawInflateStream.FixedLiteralLengthTable,this.distTable=n.RawInflateStream.FixedDistanceTable,this.status=n.RawInflateStream.Status.BLOCK_BODY_END,0},n.RawInflateStream.prototype.save_=function(){this.ip_=this.ip,this.bitsbuflen_=this.bitsbuflen,this.bitsbuf_=this.bitsbuf},n.RawInflateStream.prototype.restore_=function(){this.ip=this.ip_,this.bitsbuflen=this.bitsbuflen_,this.bitsbuf=this.bitsbuf_},n.RawInflateStream.prototype.parseDynamicHuffmanBlock=function(){var t,e,i,a,o=new(r?Uint8Array:Array)(n.RawInflateStream.Order.length);if(this.status=n.RawInflateStream.Status.BLOCK_BODY_START,this.save_(),t=this.readBits(5)+257,e=this.readBits(5)+1,i=this.readBits(4)+4,t<0||e<0||i<0)return this.restore_(),-1;try{(function(){var h,l,f,c,u,d,p=0;for(u=0;u<i;++u){if((h=this.readBits(3))<0)throw new Error("not enough input");o[n.RawInflateStream.Order[u]]=h}for(a=s(o),c=new(r?Uint8Array:Array)(t+e),u=0,d=t+e;u<d;){if((l=this.readCodeByTable(a))<0)throw new Error("not enough input");switch(l){case 16:if((h=this.readBits(2))<0)throw new Error("not enough input");for(f=3+h;f--;)c[u++]=p;break;case 17:if((h=this.readBits(3))<0)throw new Error("not enough input");for(f=3+h;f--;)c[u++]=0;p=0;break;case 18:if((h=this.readBits(7))<0)throw new Error("not enough input");for(f=11+h;f--;)c[u++]=0;p=0;break;default:c[u++]=l,p=l}}new(r?Uint8Array:Array)(t),new(r?Uint8Array:Array)(e),this.litlenTable=s(r?c.subarray(0,t):c.slice(0,t)),this.distTable=s(r?c.subarray(t):c.slice(t))}).call(this)}catch(t){return this.restore_(),-1}return this.status=n.RawInflateStream.Status.BLOCK_BODY_END,0},n.RawInflateStream.prototype.decodeHuffman=function(){var t,e,i,r,a,s=this.output,o=this.op,h=this.litlenTable,l=this.distTable,f=s.length;for(this.status=n.RawInflateStream.Status.DECODE_BLOCK_START;;){if(this.save_(),(t=this.readCodeByTable(h))<0)return this.op=o,this.restore_(),-1;if(256===t)break;if(t<256)o===f&&(f=(s=this.expandBuffer()).length),s[o++]=t;else{if(e=t-257,r=n.RawInflateStream.LengthCodeTable[e],n.RawInflateStream.LengthExtraTable[e]>0){if((a=this.readBits(n.RawInflateStream.LengthExtraTable[e]))<0)return this.op=o,this.restore_(),-1;r+=a}if((t=this.readCodeByTable(l))<0)return this.op=o,this.restore_(),-1;if(i=n.RawInflateStream.DistCodeTable[t],n.RawInflateStream.DistExtraTable[t]>0){if((a=this.readBits(n.RawInflateStream.DistExtraTable[t]))<0)return this.op=o,this.restore_(),-1;i+=a}for(o+r>=f&&(f=(s=this.expandBuffer()).length);r--;)s[o]=s[o++-i];if(this.ip===this.input.length)return this.op=o,-1}}for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=o,this.status=n.RawInflateStream.Status.DECODE_BLOCK_END},n.RawInflateStream.prototype.expandBuffer=function(t){var e,i,n,a=this.input.length/this.ip+1|0,s=this.input,o=this.output;return t&&("number"==typeof t.fixRatio&&(a=t.fixRatio),"number"==typeof t.addRatio&&(a+=t.addRatio)),i=a<2?(n=(s.length-this.ip)/this.litlenTable[2]/2*258|0)<o.length?o.length+n:o.length<<1:o.length*a,r?(e=new Uint8Array(i)).set(o):e=o,this.output=e,this.output},n.RawInflateStream.prototype.concatBuffer=function(){var t,e,i=this.op;return t=this.resize?r?new Uint8Array(this.output.subarray(this.sp,i)):this.output.slice(this.sp,i):r?this.output.subarray(this.sp,i):this.output.slice(this.sp,i),this.sp=i,i>n.RawInflateStream.MaxBackwardLength+this.bufferSize&&(this.op=this.sp=n.RawInflateStream.MaxBackwardLength,r?(e=this.output,this.output=new Uint8Array(this.bufferSize+n.RawInflateStream.MaxBackwardLength),this.output.set(e.subarray(i-n.RawInflateStream.MaxBackwardLength,i))):this.output=this.output.slice(i-n.RawInflateStream.MaxBackwardLength)),t},n.Inflate=function(t,e){var i,r;switch(this.input=t,this.ip=0,this.rawinflate,this.verify,!e&&(e={})||(e.index&&(this.ip=e.index),e.verify&&(this.verify=e.verify)),i=t[this.ip++],r=t[this.ip++],15&i){case n.CompressionMethod.DEFLATE:this.method=n.CompressionMethod.DEFLATE;break;default:throw new Error("unsupported compression method")}if(((i<<8)+r)%31!=0)throw new Error("invalid fcheck flag:"+((i<<8)+r)%31);if(32&r)throw new Error("fdict flag is not supported");this.rawinflate=new n.RawInflate(t,{index:this.ip,bufferSize:e.bufferSize,bufferType:e.bufferType,resize:e.resize})},n.Inflate.BufferType=n.RawInflate.BufferType,n.Inflate.prototype.decompress=function(){var t,e=this.input;if(t=this.rawinflate.decompress(),this.ip=this.rawinflate.ip,this.verify&&(e[this.ip++]<<24|e[this.ip++]<<16|e[this.ip++]<<8|e[this.ip++])>>>0!==n.Adler32(t))throw new Error("invalid adler-32 checksum");return t},n.InflateStream=function(t){this.input=void 0===t?new(r?Uint8Array:Array):t,this.ip=0,this.rawinflate=new n.RawInflateStream(this.input,this.ip),this.method,this.output=this.rawinflate.output},n.InflateStream.prototype.decompress=function(t){var e;if(void 0!==t)if(r){var i=new Uint8Array(this.input.length+t.length);i.set(this.input,0),i.set(t,this.input.length),this.input=i}else this.input=this.input.concat(t);return void 0===this.method&&this.readHeader()<0?new(r?Uint8Array:Array):(e=this.rawinflate.decompress(this.input,this.ip),0!==this.rawinflate.ip&&(this.input=r?this.input.subarray(this.rawinflate.ip):this.input.slice(this.rawinflate.ip),this.ip=0),e)},n.InflateStream.prototype.readHeader=function(){var t=this.ip,e=this.input,i=e[t++],r=e[t++];if(void 0===i||void 0===r)return-1;switch(15&i){case n.CompressionMethod.DEFLATE:this.method=n.CompressionMethod.DEFLATE;break;default:throw new Error("unsupported compression method")}if(((i<<8)+r)%31!=0)throw new Error("invalid fcheck flag:"+((i<<8)+r)%31);if(32&r)throw new Error("fdict flag is not supported");this.ip=t},n.Gunzip=function(t,e){this.input=t,this.ip=0,this.member=[],this.decompressed=!1},n.Gunzip.prototype.getMembers=function(){return this.decompressed||this.decompress(),this.member.slice()},n.Gunzip.prototype.decompress=function(){for(var t=this.input.length;this.ip<t;)this.decodeMember();return this.decompressed=!0,this.concatMember()},n.Gunzip.prototype.decodeMember=function(){var t,e,i,r,a,s,o,h,l,f=new n.GunzipMember,c=this.input,u=this.ip;if(f.id1=c[u++],f.id2=c[u++],31!==f.id1||139!==f.id2)throw new Error("invalid file signature:"+f.id1+","+f.id2);switch(f.cm=c[u++],f.cm){case 8:break;default:throw new Error("unknown compression method: "+f.cm)}if(f.flg=c[u++],h=c[u++]|c[u++]<<8|c[u++]<<16|c[u++]<<24,f.mtime=new Date(1e3*h),f.xfl=c[u++],f.os=c[u++],(f.flg&n.Gzip.FlagsMask.FEXTRA)>0&&(f.xlen=c[u++]|c[u++]<<8,u=this.decodeSubField(u,f.xlen)),(f.flg&n.Gzip.FlagsMask.FNAME)>0){for(o=[],s=0;(a=c[u++])>0;)o[s++]=String.fromCharCode(a);f.name=o.join("")}if((f.flg&n.Gzip.FlagsMask.FCOMMENT)>0){for(o=[],s=0;(a=c[u++])>0;)o[s++]=String.fromCharCode(a);f.comment=o.join("")}if((f.flg&n.Gzip.FlagsMask.FHCRC)>0&&(f.crc16=65535&n.CRC32.calc(c,0,u),f.crc16!==(c[u++]|c[u++]<<8)))throw new Error("invalid header crc16");if(t=c[c.length-4]|c[c.length-3]<<8|c[c.length-2]<<16|c[c.length-1]<<24,c.length-u-4-4<512*t&&(r=t),e=new n.RawInflate(c,{index:u,bufferSize:r}),f.data=i=e.decompress(),u=e.ip,f.crc32=l=(c[u++]|c[u++]<<8|c[u++]<<16|c[u++]<<24)>>>0,n.CRC32.calc(i)!==l)throw new Error("invalid CRC-32 checksum: 0x"+n.CRC32.calc(i).toString(16)+" / 0x"+l.toString(16));if(f.isize=t=(c[u++]|c[u++]<<8|c[u++]<<16|c[u++]<<24)>>>0,(4294967295&i.length)!==t)throw new Error("invalid input size: "+(4294967295&i.length)+" / "+t);this.member.push(f),this.ip=u},n.Gunzip.prototype.decodeSubField=function(t,e){return t+e},n.Gunzip.prototype.concatMember=function(){var t,e,i,n=this.member,a=0,s=0;for(t=0,e=n.length;t<e;++t)s+=n[t].data.length;if(r)for(i=new Uint8Array(s),t=0;t<e;++t)i.set(n[t].data,a),a+=n[t].data.length;else{for(i=[],t=0;t<e;++t)i[t]=n[t].data;i=Array.prototype.concat.apply([],i)}return i},n.GunzipMember=function(){this.id1,this.id2,this.cm,this.flg,this.mtime,this.xfl,this.os,this.crc16,this.xlen,this.crc32,this.isize,this.name,this.comment,this.data},n.GunzipMember.prototype.getName=function(){return this.name},n.GunzipMember.prototype.getData=function(){return this.data},n.GunzipMember.prototype.getMtime=function(){return this.mtime},n.Gzip=function(t,e){this.input=t,this.ip=0,this.output,this.op=0,this.flags={},this.filename,this.comment,this.deflateOptions,e&&(e.flags&&(this.flags=e.flags),"string"==typeof e.filename&&(this.filename=e.filename),"string"==typeof e.comment&&(this.comment=e.comment),e.deflateOptions&&(this.deflateOptions=e.deflateOptions)),this.deflateOptions||(this.deflateOptions={})},n.Gzip.DefaultBufferSize=32768,n.Gzip.prototype.compress=function(){var t,e,i,a,s,o,h,l,f=new(r?Uint8Array:Array)(n.Gzip.DefaultBufferSize),c=0,u=this.input,d=this.ip,p=this.filename,g=this.comment;if(f[c++]=31,f[c++]=139,f[c++]=8,t=0,this.flags.fname&&(t|=n.Gzip.FlagsMask.FNAME),this.flags.fcomment&&(t|=n.Gzip.FlagsMask.FCOMMENT),this.flags.fhcrc&&(t|=n.Gzip.FlagsMask.FHCRC),f[c++]=t,e=(Date.now?Date.now():+new Date)/1e3|0,f[c++]=255&e,f[c++]=e>>>8&255,f[c++]=e>>>16&255,f[c++]=e>>>24&255,f[c++]=0,f[c++]=n.Gzip.OperatingSystem.UNKNOWN,void 0!==this.flags.fname){for(h=0,l=p.length;h<l;++h)(o=p.charCodeAt(h))>255&&(f[c++]=o>>>8&255),f[c++]=255&o;f[c++]=0}if(this.flags.comment){for(h=0,l=g.length;h<l;++h)(o=g.charCodeAt(h))>255&&(f[c++]=o>>>8&255),f[c++]=255&o;f[c++]=0}return this.flags.fhcrc&&(i=65535&n.CRC32.calc(f,0,c),f[c++]=255&i,f[c++]=i>>>8&255),this.deflateOptions.outputBuffer=f,this.deflateOptions.outputIndex=c,f=(s=new n.RawDeflate(u,this.deflateOptions)).compress(),c=s.op,r&&(c+8>f.buffer.byteLength?(this.output=new Uint8Array(c+8),this.output.set(new Uint8Array(f.buffer)),f=this.output):f=new Uint8Array(f.buffer)),a=n.CRC32.calc(u),f[c++]=255&a,f[c++]=a>>>8&255,f[c++]=a>>>16&255,f[c++]=a>>>24&255,l=u.length,f[c++]=255&l,f[c++]=l>>>8&255,f[c++]=l>>>16&255,f[c++]=l>>>24&255,this.ip=d,r&&c<f.length&&(this.output=f=f.subarray(0,c)),f},n.Gzip.OperatingSystem={FAT:0,AMIGA:1,VMS:2,UNIX:3,VM_CMS:4,ATARI_TOS:5,HPFS:6,MACINTOSH:7,Z_SYSTEM:8,CP_M:9,TOPS_20:10,NTFS:11,QDOS:12,ACORN_RISCOS:13,UNKNOWN:255},n.Gzip.FlagsMask={FTEXT:1,FHCRC:2,FEXTRA:4,FNAME:8,FCOMMENT:16},n.Heap=function(t){this.buffer=new(r?Uint16Array:Array)(2*t),this.length=0},n.Heap.prototype.getParent=function(t){return 2*((t-2)/4|0)},n.Heap.prototype.getChild=function(t){return 2*t+2},n.Heap.prototype.push=function(t,e){var i,r,n,a=this.buffer;for(i=this.length,a[this.length++]=e,a[this.length++]=t;i>0&&(r=this.getParent(i),a[i]>a[r]);)n=a[i],a[i]=a[r],a[r]=n,n=a[i+1],a[i+1]=a[r+1],a[r+1]=n,i=r;return this.length},n.Heap.prototype.pop=function(){var t,e,i,r,n,a=this.buffer;for(e=a[0],t=a[1],this.length-=2,a[0]=a[this.length],a[1]=a[this.length+1],n=0;!((r=this.getChild(n))>=this.length)&&(r+2<this.length&&a[r+2]>a[r]&&(r+=2),a[r]>a[n]);)i=a[n],a[n]=a[r],a[r]=i,i=a[n+1],a[n+1]=a[r+1],a[r+1]=i,n=r;return{index:t,value:e,length:this.length}},n.RawDeflate=function(t,e){this.compressionType=n.RawDeflate.CompressionType.DYNAMIC,this.lazy=0,this.freqsLitLen,this.freqsDist,this.input=r&&t instanceof Array?new Uint8Array(t):t,this.output,this.op=0,e&&(e.lazy&&(this.lazy=e.lazy),"number"==typeof e.compressionType&&(this.compressionType=e.compressionType),e.outputBuffer&&(this.output=r&&e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"==typeof e.outputIndex&&(this.op=e.outputIndex)),this.output||(this.output=new(r?Uint8Array:Array)(32768))},n.RawDeflate.CompressionType={NONE:0,FIXED:1,DYNAMIC:2,RESERVED:3},n.RawDeflate.Lz77MinLength=3,n.RawDeflate.Lz77MaxLength=258,n.RawDeflate.WindowSize=32768,n.RawDeflate.MaxCodeLength=16,n.RawDeflate.HUFMAX=286,n.RawDeflate.FixedHuffmanTable=function(){var t,e=[];for(t=0;t<288;t++)switch(!0){case t<=143:e.push([t+48,8]);break;case t<=255:e.push([t-144+400,9]);break;case t<=279:e.push([t-256+0,7]);break;case t<=287:e.push([t-280+192,8]);break;default:throw"invalid literal: "+t}return e}(),n.RawDeflate.prototype.compress=function(){var t,e,i,a=this.input;switch(this.compressionType){case n.RawDeflate.CompressionType.NONE:for(e=0,i=a.length;e<i;)e+=(t=r?a.subarray(e,e+65535):a.slice(e,e+65535)).length,this.makeNocompressBlock(t,e===i);break;case n.RawDeflate.CompressionType.FIXED:this.output=this.makeFixedHuffmanBlock(a,!0),this.op=this.output.length;break;case n.RawDeflate.CompressionType.DYNAMIC:this.output=this.makeDynamicHuffmanBlock(a,!0),this.op=this.output.length;break;default:throw"invalid compression type"}return this.output},n.RawDeflate.prototype.makeNocompressBlock=function(t,e){var i,a,s,o,h,l,f=this.output,c=this.op;if(r){for(f=new Uint8Array(this.output.buffer);f.length<=c+t.length+5;)f=new Uint8Array(f.length<<1);f.set(this.output)}if(i=e?1:0,a=n.RawDeflate.CompressionType.NONE,f[c++]=i|a<<1,o=65536+~(s=t.length)&65535,f[c++]=255&s,f[c++]=s>>>8&255,f[c++]=255&o,f[c++]=o>>>8&255,r)f.set(t,c),c+=t.length,f=f.subarray(0,c);else{for(h=0,l=t.length;h<l;++h)f[c++]=t[h];f.length=c}return this.op=c,this.output=f,f},n.RawDeflate.prototype.makeFixedHuffmanBlock=function(t,e){var i,a,s,o=new n.BitStream(r?new Uint8Array(this.output.buffer):this.output,this.op);return i=e?1:0,a=n.RawDeflate.CompressionType.FIXED,o.writeBits(i,1,!0),o.writeBits(a,2,!0),s=this.lz77(t),this.fixedHuffman(s,o),o.finish()},n.RawDeflate.prototype.makeDynamicHuffmanBlock=function(t,e){var i,a,s,o,h,l,f,c,u,d,p,g,m,b,w,y,v,x=new n.BitStream(r?new Uint8Array(this.output.buffer):this.output,this.op),_=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=new Array(19);for(i=e?1:0,a=n.RawDeflate.CompressionType.DYNAMIC,x.writeBits(i,1,!0),x.writeBits(a,2,!0),s=this.lz77(t),f=this.getLengths_(this.freqsLitLen,15),c=this.getCodesFromLengths_(f),u=this.getLengths_(this.freqsDist,7),d=this.getCodesFromLengths_(u),o=286;o>257&&0===f[o-1];o--);for(h=30;h>1&&0===u[h-1];h--);for(p=this.getTreeSymbols_(o,f,h,u),g=this.getLengths_(p.freqs,7),y=0;y<19;y++)k[y]=g[_[y]];for(l=19;l>4&&0===k[l-1];l--);for(m=this.getCodesFromLengths_(g),x.writeBits(o-257,5,!0),x.writeBits(h-1,5,!0),x.writeBits(l-4,4,!0),y=0;y<l;y++)x.writeBits(k[y],3,!0);for(y=0,v=p.codes.length;y<v;y++)if(b=p.codes[y],x.writeBits(m[b],g[b],!0),b>=16){switch(y++,b){case 16:w=2;break;case 17:w=3;break;case 18:w=7;break;default:throw"invalid code: "+b}x.writeBits(p.codes[y],w,!0)}return this.dynamicHuffman(s,[c,f],[d,u],x),x.finish()},n.RawDeflate.prototype.dynamicHuffman=function(t,e,i,r){var n,a,s,o,h,l,f,c;for(h=e[0],l=e[1],f=i[0],c=i[1],n=0,a=t.length;n<a;++n)if(s=t[n],r.writeBits(h[s],l[s],!0),s>256)r.writeBits(t[++n],t[++n],!0),o=t[++n],r.writeBits(f[o],c[o],!0),r.writeBits(t[++n],t[++n],!0);else if(256===s)break;return r},n.RawDeflate.prototype.fixedHuffman=function(t,e){var i,r,a;for(i=0,r=t.length;i<r;i++)if(a=t[i],n.BitStream.prototype.writeBits.apply(e,n.RawDeflate.FixedHuffmanTable[a]),a>256)e.writeBits(t[++i],t[++i],!0),e.writeBits(t[++i],5),e.writeBits(t[++i],t[++i],!0);else if(256===a)break;return e},n.RawDeflate.Lz77Match=function(t,e){this.length=t,this.backwardDistance=e},n.RawDeflate.Lz77Match.LengthCodeTable=function(t){return r?new Uint32Array(t):t}(function(){var t,e,i=[];for(t=3;t<=258;t++)e=r(t),i[t]=e[2]<<24|e[1]<<16|e[0];function r(t){switch(!0){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case t<=12:return[265,t-11,1];case t<=14:return[266,t-13,1];case t<=16:return[267,t-15,1];case t<=18:return[268,t-17,1];case t<=22:return[269,t-19,2];case t<=26:return[270,t-23,2];case t<=30:return[271,t-27,2];case t<=34:return[272,t-31,2];case t<=42:return[273,t-35,3];case t<=50:return[274,t-43,3];case t<=58:return[275,t-51,3];case t<=66:return[276,t-59,3];case t<=82:return[277,t-67,4];case t<=98:return[278,t-83,4];case t<=114:return[279,t-99,4];case t<=130:return[280,t-115,4];case t<=162:return[281,t-131,5];case t<=194:return[282,t-163,5];case t<=226:return[283,t-195,5];case t<=257:return[284,t-227,5];case 258===t:return[285,t-258,0];default:throw"invalid length: "+t}}return i}()),n.RawDeflate.Lz77Match.prototype.getDistanceCode_=function(t){var e;switch(!0){case 1===t:e=[0,t-1,0];break;case 2===t:e=[1,t-2,0];break;case 3===t:e=[2,t-3,0];break;case 4===t:e=[3,t-4,0];break;case t<=6:e=[4,t-5,1];break;case t<=8:e=[5,t-7,1];break;case t<=12:e=[6,t-9,2];break;case t<=16:e=[7,t-13,2];break;case t<=24:e=[8,t-17,3];break;case t<=32:e=[9,t-25,3];break;case t<=48:e=[10,t-33,4];break;case t<=64:e=[11,t-49,4];break;case t<=96:e=[12,t-65,5];break;case t<=128:e=[13,t-97,5];break;case t<=192:e=[14,t-129,6];break;case t<=256:e=[15,t-193,6];break;case t<=384:e=[16,t-257,7];break;case t<=512:e=[17,t-385,7];break;case t<=768:e=[18,t-513,8];break;case t<=1024:e=[19,t-769,8];break;case t<=1536:e=[20,t-1025,9];break;case t<=2048:e=[21,t-1537,9];break;case t<=3072:e=[22,t-2049,10];break;case t<=4096:e=[23,t-3073,10];break;case t<=6144:e=[24,t-4097,11];break;case t<=8192:e=[25,t-6145,11];break;case t<=12288:e=[26,t-8193,12];break;case t<=16384:e=[27,t-12289,12];break;case t<=24576:e=[28,t-16385,13];break;case t<=32768:e=[29,t-24577,13];break;default:throw"invalid distance"}return e},n.RawDeflate.Lz77Match.prototype.toLz77Array=function(){var t,e=this.length,i=this.backwardDistance,r=[],a=0;return t=n.RawDeflate.Lz77Match.LengthCodeTable[e],r[a++]=65535&t,r[a++]=t>>16&255,r[a++]=t>>24,t=this.getDistanceCode_(i),r[a++]=t[0],r[a++]=t[1],r[a++]=t[2],r},n.RawDeflate.prototype.lz77=function(t){var e,i,a,s,o,h,l,f,c,u={},d=n.RawDeflate.WindowSize,p=r?new Uint16Array(2*t.length):[],g=0,m=0,b=new(r?Uint32Array:Array)(286),w=new(r?Uint32Array:Array)(30),y=this.lazy;if(!r){for(a=0;a<=285;)b[a++]=0;for(a=0;a<=29;)w[a++]=0}function v(t,e){var i,r,n=t.toLz77Array();for(i=0,r=n.length;i<r;++i)p[g++]=n[i];b[n[0]]++,w[n[3]]++,m=t.length+e-1,f=null}for(b[256]=1,e=0,i=t.length;e<i;++e){for(o=0,a=0,s=n.RawDeflate.Lz77MinLength;a<s&&e+a!==i;++a)o=o<<8|t[e+a];if(void 0===u[o]&&(u[o]=[]),h=u[o],m-- >0)h.push(e);else{for(;h.length>0&&e-h[0]>d;)h.shift();if(e+n.RawDeflate.Lz77MinLength>=i){for(f&&v(f,-1),a=0,s=i-e;a<s;++a)c=t[e+a],p[g++]=c,++b[c];break}h.length>0?(l=this.searchLongestMatch_(t,e,h),f?f.length<l.length?(c=t[e-1],p[g++]=c,++b[c],v(l,0)):v(f,-1):l.length<y?f=l:v(l,0)):f?v(f,-1):(c=t[e],p[g++]=c,++b[c]),h.push(e)}}return p[g++]=256,b[256]++,this.freqsLitLen=b,this.freqsDist=w,r?p.subarray(0,g):p},n.RawDeflate.prototype.searchLongestMatch_=function(t,e,i){var r,a,s,o,h,l,f=0,c=t.length;t:for(o=0,l=i.length;o<l;o++){if(r=i[l-o-1],s=n.RawDeflate.Lz77MinLength,f>n.RawDeflate.Lz77MinLength){for(h=f;h>n.RawDeflate.Lz77MinLength;h--)if(t[r+h-1]!==t[e+h-1])continue t;s=f}for(;s<n.RawDeflate.Lz77MaxLength&&e+s<c&&t[r+s]===t[e+s];)++s;if(s>f&&(a=r,f=s),s===n.RawDeflate.Lz77MaxLength)break}return new n.RawDeflate.Lz77Match(f,e-a)},n.RawDeflate.prototype.getTreeSymbols_=function(t,e,i,n){var a,s,o,h,l,f,c=new(r?Uint32Array:Array)(t+i),u=new(r?Uint32Array:Array)(316),d=new(r?Uint8Array:Array)(19);for(s=0,a=0;a<t;a++)c[s++]=e[a];for(a=0;a<i;a++)c[s++]=n[a];if(!r)for(a=0,h=d.length;a<h;++a)d[a]=0;for(l=0,a=0,h=c.length;a<h;a+=s){for(s=1;a+s<h&&c[a+s]===c[a];++s);if(o=s,0===c[a])if(o<3)for(;o-- >0;)u[l++]=0,d[0]++;else for(;o>0;)(f=o<138?o:138)>o-3&&f<o&&(f=o-3),f<=10?(u[l++]=17,u[l++]=f-3,d[17]++):(u[l++]=18,u[l++]=f-11,d[18]++),o-=f;else if(u[l++]=c[a],d[c[a]]++,--o<3)for(;o-- >0;)u[l++]=c[a],d[c[a]]++;else for(;o>0;)(f=o<6?o:6)>o-3&&f<o&&(f=o-3),u[l++]=16,u[l++]=f-3,d[16]++,o-=f}return{codes:r?u.subarray(0,l):u.slice(0,l),freqs:d}},n.RawDeflate.prototype.getLengths_=function(t,e){var i,a,s,o,h,l=t.length,f=new n.Heap(2*n.RawDeflate.HUFMAX),c=new(r?Uint8Array:Array)(l);if(!r)for(o=0;o<l;o++)c[o]=0;for(o=0;o<l;++o)t[o]>0&&f.push(o,t[o]);if(i=new Array(f.length/2),a=new(r?Uint32Array:Array)(f.length/2),1===i.length)return c[f.pop().index]=1,c;for(o=0,h=f.length/2;o<h;++o)i[o]=f.pop(),a[o]=i[o].value;for(s=this.reversePackageMerge_(a,a.length,e),o=0,h=i.length;o<h;++o)c[i[o].index]=s[o];return c},n.RawDeflate.prototype.reversePackageMerge_=function(t,e,i){var n,a,s,o,h,l=new(r?Uint16Array:Array)(i),f=new(r?Uint8Array:Array)(i),c=new(r?Uint8Array:Array)(e),u=new Array(i),d=new Array(i),p=new Array(i),g=(1<<i)-e,m=1<<i-1;function b(t){var i=d[t][p[t]];i===e?(b(t+1),b(t+1)):--c[i],++p[t]}for(l[i-1]=e,a=0;a<i;++a)g<m?f[a]=0:(f[a]=1,g-=m),g<<=1,l[i-2-a]=(l[i-1-a]/2|0)+e;for(l[0]=f[0],u[0]=new Array(l[0]),d[0]=new Array(l[0]),a=1;a<i;++a)l[a]>2*l[a-1]+f[a]&&(l[a]=2*l[a-1]+f[a]),u[a]=new Array(l[a]),d[a]=new Array(l[a]);for(n=0;n<e;++n)c[n]=i;for(s=0;s<l[i-1];++s)u[i-1][s]=t[s],d[i-1][s]=s;for(n=0;n<i;++n)p[n]=0;for(1===f[i-1]&&(--c[0],++p[i-1]),a=i-2;a>=0;--a){for(n=0,o=0,h=p[a+1],s=0;s<l[a];s++)(o=u[a+1][h]+u[a+1][h+1])>t[n]?(u[a][s]=o,d[a][s]=e,h+=2):(u[a][s]=t[n],d[a][s]=n,++n);p[a]=0,1===f[a]&&b(a)}return c},n.RawDeflate.prototype.getCodesFromLengths_=function(t){var e,i,a,s,o=new(r?Uint16Array:Array)(t.length),h=[],l=[],f=0;for(e=0,i=t.length;e<i;e++)h[t[e]]=1+(0|h[t[e]]);for(e=1,i=n.RawDeflate.MaxCodeLength;e<=i;e++)l[e]=f,f+=0|h[e],f<<=1;for(e=0,i=t.length;e<i;e++)for(f=l[t[e]],l[t[e]]+=1,o[e]=0,a=0,s=t[e];a<s;a++)o[e]=o[e]<<1|1&f,f>>>=1;return o},n.Unzip=function(t,e){e=e||{},this.input=r&&t instanceof Array?new Uint8Array(t):t,this.ip=0,this.eocdrOffset,this.numberOfThisDisk,this.startDisk,this.totalEntriesThisDisk,this.totalEntries,this.centralDirectorySize,this.centralDirectoryOffset,this.commentLength,this.comment,this.fileHeaderList,this.filenameToIndex,this.verify=e.verify||!1,this.password=e.password},n.Unzip.CompressionMethod=n.Zip.CompressionMethod,n.Unzip.FileHeaderSignature=n.Zip.FileHeaderSignature,n.Unzip.LocalFileHeaderSignature=n.Zip.LocalFileHeaderSignature,n.Unzip.CentralDirectorySignature=n.Zip.CentralDirectorySignature,n.Unzip.FileHeader=function(t,e){this.input=t,this.offset=e,this.length,this.version,this.os,this.needVersion,this.flags,this.compression,this.time,this.date,this.crc32,this.compressedSize,this.plainSize,this.fileNameLength,this.extraFieldLength,this.fileCommentLength,this.diskNumberStart,this.internalFileAttributes,this.externalFileAttributes,this.relativeOffset,this.filename,this.extraField,this.comment},n.Unzip.FileHeader.prototype.parse=function(){var t=this.input,e=this.offset;if(t[e++]!==n.Unzip.FileHeaderSignature[0]||t[e++]!==n.Unzip.FileHeaderSignature[1]||t[e++]!==n.Unzip.FileHeaderSignature[2]||t[e++]!==n.Unzip.FileHeaderSignature[3])throw new Error("invalid file header signature");this.version=t[e++],this.os=t[e++],this.needVersion=t[e++]|t[e++]<<8,this.flags=t[e++]|t[e++]<<8,this.compression=t[e++]|t[e++]<<8,this.time=t[e++]|t[e++]<<8,this.date=t[e++]|t[e++]<<8,this.crc32=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.compressedSize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.plainSize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.fileNameLength=t[e++]|t[e++]<<8,this.extraFieldLength=t[e++]|t[e++]<<8,this.fileCommentLength=t[e++]|t[e++]<<8,this.diskNumberStart=t[e++]|t[e++]<<8,this.internalFileAttributes=t[e++]|t[e++]<<8,this.externalFileAttributes=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24,this.relativeOffset=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.filename=String.fromCharCode.apply(null,r?t.subarray(e,e+=this.fileNameLength):t.slice(e,e+=this.fileNameLength)),this.extraField=r?t.subarray(e,e+=this.extraFieldLength):t.slice(e,e+=this.extraFieldLength),this.comment=r?t.subarray(e,e+this.fileCommentLength):t.slice(e,e+this.fileCommentLength),this.length=e-this.offset},n.Unzip.LocalFileHeader=function(t,e){this.input=t,this.offset=e,this.length,this.needVersion,this.flags,this.compression,this.time,this.date,this.crc32,this.compressedSize,this.plainSize,this.fileNameLength,this.extraFieldLength,this.filename,this.extraField},n.Unzip.LocalFileHeader.Flags=n.Zip.Flags,n.Unzip.LocalFileHeader.prototype.parse=function(){var t=this.input,e=this.offset;if(t[e++]!==n.Unzip.LocalFileHeaderSignature[0]||t[e++]!==n.Unzip.LocalFileHeaderSignature[1]||t[e++]!==n.Unzip.LocalFileHeaderSignature[2]||t[e++]!==n.Unzip.LocalFileHeaderSignature[3])throw new Error("invalid local file header signature");this.needVersion=t[e++]|t[e++]<<8,this.flags=t[e++]|t[e++]<<8,this.compression=t[e++]|t[e++]<<8,this.time=t[e++]|t[e++]<<8,this.date=t[e++]|t[e++]<<8,this.crc32=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.compressedSize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.plainSize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.fileNameLength=t[e++]|t[e++]<<8,this.extraFieldLength=t[e++]|t[e++]<<8,this.filename=String.fromCharCode.apply(null,r?t.subarray(e,e+=this.fileNameLength):t.slice(e,e+=this.fileNameLength)),this.extraField=r?t.subarray(e,e+=this.extraFieldLength):t.slice(e,e+=this.extraFieldLength),this.length=e-this.offset},n.Unzip.prototype.searchEndOfCentralDirectoryRecord=function(){var t,e=this.input;for(t=e.length-12;t>0;--t)if(e[t]===n.Unzip.CentralDirectorySignature[0]&&e[t+1]===n.Unzip.CentralDirectorySignature[1]&&e[t+2]===n.Unzip.CentralDirectorySignature[2]&&e[t+3]===n.Unzip.CentralDirectorySignature[3])return void(this.eocdrOffset=t);throw new Error("End of Central Directory Record not found")},n.Unzip.prototype.parseEndOfCentralDirectoryRecord=function(){var t,e=this.input;if(this.eocdrOffset||this.searchEndOfCentralDirectoryRecord(),t=this.eocdrOffset,e[t++]!==n.Unzip.CentralDirectorySignature[0]||e[t++]!==n.Unzip.CentralDirectorySignature[1]||e[t++]!==n.Unzip.CentralDirectorySignature[2]||e[t++]!==n.Unzip.CentralDirectorySignature[3])throw new Error("invalid signature");this.numberOfThisDisk=e[t++]|e[t++]<<8,this.startDisk=e[t++]|e[t++]<<8,this.totalEntriesThisDisk=e[t++]|e[t++]<<8,this.totalEntries=e[t++]|e[t++]<<8,this.centralDirectorySize=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.centralDirectoryOffset=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.commentLength=e[t++]|e[t++]<<8,this.comment=r?e.subarray(t,t+this.commentLength):e.slice(t,t+this.commentLength)},n.Unzip.prototype.parseFileHeader=function(){var t,e,i,r,a=[],s={};if(!this.fileHeaderList){for(void 0===this.centralDirectoryOffset&&this.parseEndOfCentralDirectoryRecord(),t=this.centralDirectoryOffset,i=0,r=this.totalEntries;i<r;++i)(e=new n.Unzip.FileHeader(this.input,t)).parse(),t+=e.length,a[i]=e,s[e.filename]=i;if(this.centralDirectorySize<t-this.centralDirectoryOffset)throw new Error("invalid file header size");this.fileHeaderList=a,this.filenameToIndex=s}},n.Unzip.prototype.getFileData=function(t,e){e=e||{};var i,a,s,o,h,l,f,c,u=this.input,d=this.fileHeaderList;if(d||this.parseFileHeader(),void 0===d[t])throw new Error("wrong index");if(a=d[t].relativeOffset,(i=new n.Unzip.LocalFileHeader(this.input,a)).parse(),a+=i.length,s=i.compressedSize,0!=(i.flags&n.Unzip.LocalFileHeader.Flags.ENCRYPT)){if(!e.password&&!this.password)throw new Error("please set password");for(l=this.createDecryptionKey(e.password||this.password),f=a,c=a+12;f<c;++f)this.decode(l,u[f]);for(f=a+=12,c=a+(s-=12);f<c;++f)u[f]=this.decode(l,u[f])}switch(i.compression){case n.Unzip.CompressionMethod.STORE:o=r?this.input.subarray(a,a+s):this.input.slice(a,a+s);break;case n.Unzip.CompressionMethod.DEFLATE:o=new n.RawInflate(this.input,{index:a,bufferSize:i.plainSize}).decompress();break;default:throw new Error("unknown compression type")}if(this.verify&&(h=n.CRC32.calc(o),i.crc32!==h))throw new Error("wrong crc: file=0x"+i.crc32.toString(16)+", data=0x"+h.toString(16));return o},n.Unzip.prototype.getFilenames=function(){var t,e,i,r=[];for(this.fileHeaderList||this.parseFileHeader(),t=0,e=(i=this.fileHeaderList).length;t<e;++t)r[t]=i[t].filename;return r},n.Unzip.prototype.decompress=function(t,e){var i;if(this.filenameToIndex||this.parseFileHeader(),void 0===(i=this.filenameToIndex[t]))throw new Error(t+" not found");return this.getFileData(i,e)},n.Unzip.prototype.setPassword=function(t){this.password=t},n.Unzip.prototype.decode=function(t,e){return e^=this.getByte(t),this.updateKeys(t,e),e},n.Unzip.prototype.updateKeys=n.Zip.prototype.updateKeys,n.Unzip.prototype.createDecryptionKey=n.Zip.prototype.createEncryptionKey,n.Unzip.prototype.getByte=n.Zip.prototype.getByte,n.Util.stringToByteArray=function(t){var e,i,r=t.split("");for(e=0,i=r.length;e<i;e++)r[e]=(255&r[e].charCodeAt(0))>>>0;return r},n.Adler32=function(t){return"string"==typeof t&&(t=n.Util.stringToByteArray(t)),n.Adler32.update(1,t)},n.Adler32.update=function(t,e){for(var i,r=65535&t,a=t>>>16&65535,s=e.length,o=0;s>0;){s-=i=s>n.Adler32.OptimizationParameter?n.Adler32.OptimizationParameter:s;do{a+=r+=e[o++]}while(--i);r%=65521,a%=65521}return(a<<16|r)>>>0},n.Adler32.OptimizationParameter=1024,n.BitStream=function(t,e){if(this.index="number"==typeof e?e:0,this.bitindex=0,this.buffer=t instanceof(r?Uint8Array:Array)?t:new(r?Uint8Array:Array)(n.BitStream.DefaultBlockSize),2*this.buffer.length<=this.index)throw new Error("invalid index");this.buffer.length<=this.index&&this.expandBuffer()},n.BitStream.DefaultBlockSize=32768,n.BitStream.prototype.expandBuffer=function(){var t,e=this.buffer,i=e.length,n=new(r?Uint8Array:Array)(i<<1);if(r)n.set(e);else for(t=0;t<i;++t)n[t]=e[t];return this.buffer=n},n.BitStream.prototype.writeBits=function(t,e,i){var r,a=this.buffer,s=this.index,o=this.bitindex,h=a[s];if(i&&e>1&&(t=e>8?function(t){return n.BitStream.ReverseTable[255&t]<<24|n.BitStream.ReverseTable[t>>>8&255]<<16|n.BitStream.ReverseTable[t>>>16&255]<<8|n.BitStream.ReverseTable[t>>>24&255]}(t)>>32-e:n.BitStream.ReverseTable[t]>>8-e),e+o<8)h=h<<e|t,o+=e;else for(r=0;r<e;++r)h=h<<1|t>>e-r-1&1,8==++o&&(o=0,a[s++]=n.BitStream.ReverseTable[h],h=0,s===a.length&&(a=this.expandBuffer()));a[s]=h,this.buffer=a,this.bitindex=o,this.index=s},n.BitStream.prototype.finish=function(){var t,e=this.buffer,i=this.index;return this.bitindex>0&&(e[i]<<=8-this.bitindex,e[i]=n.BitStream.ReverseTable[e[i]],i++),r?t=e.subarray(0,i):(e.length=i,t=e),t},n.BitStream.ReverseTable=function(t){return t}(function(){var t,e=new(r?Uint8Array:Array)(256);for(t=0;t<256;++t)e[t]=function(t){var e=t,i=7;for(t>>>=1;t;t>>>=1)e<<=1,e|=1&t,--i;return(e<<i&255)>>>0}(t);return e}());n.CRC32.calc=function(t,e,i){return n.CRC32.update(t,0,e,i)},n.CRC32.update=function(t,e,i,r){var a=n.CRC32.Table,s="number"==typeof i?i:i=0,o="number"==typeof r?r:t.length;for(e^=4294967295,s=7&o;s--;++i)e=e>>>8^a[255&(e^t[i])];for(s=o>>3;s--;i+=8)e=(e=(e=(e=(e=(e=(e=(e=e>>>8^a[255&(e^t[i])])>>>8^a[255&(e^t[i+1])])>>>8^a[255&(e^t[i+2])])>>>8^a[255&(e^t[i+3])])>>>8^a[255&(e^t[i+4])])>>>8^a[255&(e^t[i+5])])>>>8^a[255&(e^t[i+6])])>>>8^a[255&(e^t[i+7])];return(4294967295^e)>>>0},n.CRC32.single=function(t,e){return(n.CRC32.Table[255&(t^e)]^t>>>8)>>>0},n.CRC32.Table_=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],n.CRC32.Table=r?new Uint32Array(n.CRC32.Table_):n.CRC32.Table_,n.Deflate=function(t,e){this.input=t,this.output=new(r?Uint8Array:Array)(n.Deflate.DefaultBufferSize),this.compressionType=n.Deflate.CompressionType.DYNAMIC,this.rawDeflate;var i,a={};for(i in!e&&(e={})||"number"==typeof e.compressionType&&(this.compressionType=e.compressionType),e)a[i]=e[i];a.outputBuffer=this.output,this.rawDeflate=new n.RawDeflate(this.input,a)},n.Deflate.DefaultBufferSize=32768,n.Deflate.CompressionType=n.RawDeflate.CompressionType,n.Deflate.compress=function(t,e){return new n.Deflate(t,e).compress()},n.Deflate.prototype.compress=function(){var t,e,i,a,s,o,h,l=0;switch(h=this.output,t=n.CompressionMethod.DEFLATE){case n.CompressionMethod.DEFLATE:e=Math.LOG2E*Math.log(n.RawDeflate.WindowSize)-8;break;default:throw new Error("invalid compression method")}switch(i=e<<4|t,h[l++]=i,0,t){case n.CompressionMethod.DEFLATE:switch(this.compressionType){case n.Deflate.CompressionType.NONE:s=0;break;case n.Deflate.CompressionType.FIXED:s=1;break;case n.Deflate.CompressionType.DYNAMIC:s=2;break;default:throw new Error("unsupported compression type")}break;default:throw new Error("invalid compression method")}return a=s<<6|0,a|=31-(256*i+a)%31,h[l++]=a,o=n.Adler32(this.input),this.rawDeflate.op=l,l=(h=this.rawDeflate.compress()).length,r&&((h=new Uint8Array(h.buffer)).length<=l+4&&(this.output=new Uint8Array(h.length+4),this.output.set(h),h=this.output),h=h.subarray(0,l+4)),h[l++]=o>>24&255,h[l++]=o>>16&255,h[l++]=o>>8&255,h[l++]=255&o,h}},function(t,e,i){"use strict";(function(t){i.d(e,"a",function(){return s}),i.d(e,"b",function(){return v});var r=i(0),n=i(2);class a{constructor(t,e,i){this.path=t.url,this.contentLength=e,this.bufferSize=i||512e3,this.range={start:-1,size:-1},this.config=t}dataViewForRange(t,e){var i=this;return new Promise(function(n,a){var s,o;function h(t,e,i){var r=t.data.byteLength,a=e.start-t.range.start,s=i?new Uint8Array(t.data,a,r-a):new DataView(t.data,a,r-a);n(s)}i.data&&i.range.start<=t.start&&i.range.start+i.range.size>=t.start+t.size?h(i,t,e):(s=Math.max(i.bufferSize,t.size),o=i.contentLength>0&&t.start+s>i.contentLength?{start:t.start}:{start:t.start,size:s},r.a.loadArrayBuffer(i.path,Object.assign(i.config,{range:o})).then(function(r){i.data=r,i.range=o,h(i,t,e)}).catch(a))})}}class s{constructor(t,e){this.reader=new u(t),this.bufferedReader=new a(t),this.create_feature=e||s.createFeature}getFeatures(t,e,i,r,a){this.st=(new Date).getTime();var o=this;return new Promise(function(h,l){o.features&&r?h(o.features):o.reader.getZoomHeaders().then(function(r){var f,c=o.reader,u=o.bufferedReader,d=a.bpPerPixel,p=s.zoomLevelForScale(d,r);p&&"BigWig"===c.type?(f=p.indexOffset,o.decodeFunction=s.decodeZoomData):(f=c.header.fullIndexOffset,"BigWig"===c.type?o.decodeFunction=s.decodeWigData:o.decodeFunction=o.decodeBedData),c.loadRPTree(f).then(function(r){var a=o.reader.chromTree.dictionary[t];void 0===a?h(null):r.findLeafItemsOverlapping(a,e,i).then(function(r){var s=[];r&&0!=r.length||h([]),r.forEach(function(r){s.push(new Promise(function(s,h){var l=[];u.dataViewForRange({start:r.dataOffset,size:r.dataSize},!0).then(function(r){var h=new n.a.Inflate(r).decompress();o.decodeFunction(new DataView(h.buffer),t,a,e,i,l),s(l)}).catch(h)}))}),Promise.all(s).then(function(t){(new Date).getTime(),o.st;var e,i=t[0];if(t.length>1)for(e=1;e<t.length;e++)i=i.concat(t[e]);i.sort(function(t,e){return t.start-e.start}),o.features=i,h(i)}).catch(l)}).catch(function(t){l(t)})}).catch(function(t){l(t)})}).catch(function(t){l(t)})})}getDefaultRange(){return void 0!=this.reader.totalSummary?this.reader.totalSummary.defaultRange:void 0}static zoomLevelForScale(t,e){var i,r,n=null;for(i=0;i<e.length;i++)if((r=e[i]).reductionLevel>t){n=r;break}return null==n&&(n=e[e.length-1]),n&&n.reductionLevel<4*t?n:null}static decodeWigData(t,e,i,r,n,a){var s,o=new v(t),h=o.getInt(),l=o.getInt(),f=o.getInt(),c=o.getInt(),u=o.getInt(),d=o.getByte(),p=(o.getByte(),o.getUShort());if(h===i)for(;p-- >0;){switch(d){case 1:l=o.getInt(),f=o.getInt(),s=o.getFloat();break;case 2:l=o.getInt(),s=o.getFloat(),f=l+u;break;case 3:s=o.getFloat(),f=l+u,l+=c}if(l>=n)break;f>r&&Number.isFinite(s)&&a.push({chr:e,start:l,end:f,value:s})}}static decodeZoomData(t,e,i,r,n,a){for(var s,o,h,l,f,c=new v(t);c.remLength()>=32;)if(c.getInt()===i){if(s=c.getInt(),o=c.getInt(),h=c.getInt(),c.getFloat(),c.getFloat(),l=c.getFloat(),c.getFloat(),f=0==h?0:l/h,s>=n&&s<1e9){console.log("should have broken");break}o>r&&Number.isFinite(f)&&a.push({chr:e,start:s,end:o,value:f})}}decodeBedData(t,e,i,r,n,a){for(var s,o,h,l,f,c=new v(t);c.remLength()>=13;)c.getInt()==i&&(s=c.getInt(),o=c.getInt(),h=c.getString(),f={chr:e,start:s,end:o},s<n&&o>=r&&(a.push(f),l=h.split("\t"),this.create_feature(l,f)))}static createFeature(t,e){if(t.length>0&&(e.name=t[0]),t.length>1&&(e.score=parseFloat(t[1])),t.length>2&&(e.strand=t[2]),t.length>3&&(e.cdStart=parseInt(t[3])),t.length>4&&(e.cdEnd=parseInt(t[4])),t.length,t.length>8){exonCount=parseInt(t[6]),exonSizes=t[7].split(","),exonStarts=t[8].split(","),exons=[];for(var i=0;i<exonCount;i++)eStart=start+parseInt(exonStarts[i]),eEnd=eStart+parseInt(exonSizes[i]),exons.push({start:eStart,end:eEnd});e.exons=exons}}}const o=2291137574,h=654085990,l=2273964779,f=3958540679,c=64;class u{constructor(e){this.path=e.url,this.headPath=e.headURL||this.path,this.rpTreeCache={},this.config=t({},e,!0)}getZoomHeaders(){var t=this;return new Promise(function(e,i){t.zoomLevelHeaders?e(t.zoomLevelHeaders):t.loadHeader().then(function(){e(t.zoomLevelHeaders)}).catch(function(t){i(t)})})}loadHeader(){var t=this;return new Promise(function(e,i){r.a.loadArrayBuffer(t.path,Object.assign(t.config,{range:{start:0,size:c}})).then(function(r){if(r){t.littleEndian=!0;var n=new v(new DataView(r));if((a=n.getUInt())===o)t.type="BigWig";else if(a==l)t.type="BigBed";else{var a;t.littleEndian=!1,n.littleEndian=!1,n.position=0,(a=n.getUInt())===h?t.type="BigWig":a==f&&(t.type="BigBed")}t.header={},t.header.bwVersion=n.getUShort(),t.header.nZoomLevels=n.getUShort(),t.header.chromTreeOffset=n.getLong(),t.header.fullDataOffset=n.getLong(),t.header.fullIndexOffset=n.getLong(),t.header.fieldCount=n.getUShort(),t.header.definedFieldCount=n.getUShort(),t.header.autoSqlOffset=n.getLong(),t.header.totalSummaryOffset=n.getLong(),t.header.uncompressBuffSize=n.getInt(),t.header.reserved=n.getLong(),t.loadZoomHeadersAndChrTree().then(e).catch(i)}}).catch(function(t){i(t)})})}loadZoomHeadersAndChrTree(){var t=c,e=this;return new Promise(function(i,n){var a={start:t,size:e.header.fullDataOffset-t+5};r.a.loadArrayBuffer(e.path,Object.assign(e.config,{range:a})).then(function(r){var n,a,s=e.header.nZoomLevels,o=new v(new DataView(r));for(e.zoomLevelHeaders=[],e.firstZoomDataOffset=Number.MAX_VALUE,n=0;n<s;n++)a=new d(s-n,o),e.firstZoomDataOffset=Math.min(a.dataOffset,e.firstZoomDataOffset),e.zoomLevelHeaders.push(a);e.header.autoSqlOffset>0&&(o.position=e.header.autoSqlOffset-t,e.autoSql=o.getString()),e.header.totalSummaryOffset>0&&(o.position=e.header.totalSummaryOffset-t,e.totalSummary=new _(o)),e.header.chromTreeOffset>0&&(o.position=e.header.chromTreeOffset-t,e.chromTree=new k(o,t)),o.position=e.header.fullDataOffset-t,e.dataCount=o.getInt(),i()}).catch(function(t){n(t)})})}loadRPTree(t){var e=this;return new Promise(function(i,r){var n=e.rpTreeCache[t];n?i(n):(n=new w(t,e.contentLength,e.config,e.littleEndian),e.rpTreeCache[t]=n,n.load().then(function(){i(n)}).catch(r))})}}class d{constructor(t,e){this.index=t,this.reductionLevel=e.getInt(),this.reserved=e.getInt(),this.dataOffset=e.getLong(),this.indexOffset=e.getLong()}}const p=48,g=32,m=24,b=512e3;class w{constructor(t,e,i,r){this.config=i,this.filesize=e,this.fileOffset=t,this.path=i.url,this.littleEndian=r}load(){var t=this;return new Promise(function(e,i){var r=t.fileOffset+p,n=new a(t.config,t.filesize,b);t.readNode(r,n).then(function(i){t.rootNode=i,e(t)}).catch(i)})}readNode(t,e){var i=this;return new Promise(function(r,n){e.dataViewForRange({start:t,size:4},!1).then(function(a){var s=new v(a,i.littleEndian),o=1===s.getByte(),h=(s.getByte(),s.getUShort()),l={start:t+=4,size:h*(o?g:m)};e.dataViewForRange(l,!1).then(function(t){var e,i=new Array(h),n=new v(t);if(o){for(e=0;e<h;e++){var a={isLeaf:!0,startChrom:n.getInt(),startBase:n.getInt(),endChrom:n.getInt(),endBase:n.getInt(),dataOffset:n.getLong(),dataSize:n.getLong()};i[e]=a}r(new y(i))}else{for(e=0;e<h;e++){a={isLeaf:!1,startChrom:n.getInt(),startBase:n.getInt(),endChrom:n.getInt(),endBase:n.getInt(),childOffset:n.getLong()};i[e]=a}r(new y(i))}}).catch(n)}).catch(n)})}findLeafItemsOverlapping(t,e,i){var r=this;return new Promise(function(n,s){var o=[],h=new Set,l=new a(r.config,r.filesize,b);h.add(0),function a(f,c){if(w.overlaps(f,t,e,i)){var u=f.items;u.forEach(function(n){w.overlaps(n,t,e,i)&&(n.isLeaf?o.push(n):n.childNode?a(n.childNode):(h.add(n.childOffset),r.readNode(n.childOffset,l).then(function(t){n.childNode=t,a(t,n.childOffset)}).catch(s)))})}void 0!=c&&h.delete(c);0===h.size&&n(o)}(r.rootNode,0)})}static overlaps(t,e,i,r){return t?(e>t.startChrom||e==t.startChrom&&r>=t.startBase)&&(e<t.endChrom||e==t.endChrom&&i<t.endBase):(console.log("null item"),!1)}}class y{constructor(t){this.items=t;var e,i,r=Number.MAX_VALUE,n=0,a=Number.MAX_VALUE,s=0;for(e=0;e<t.length;e++)i=t[e],r=Math.min(r,i.startChrom),n=Math.max(n,i.endChrom),a=Math.min(a,i.startBase),s=Math.max(s,i.endBase);this.startChrom=r,this.endChrom=n,this.startBase=a,this.endBase=s}}class v{constructor(t,e){this.littleEndian=e||!0,this.position=0,this.view=t,this.length=t.byteLength}available(){return this.length-this.position}remLength(){return this.length-this.position}hasNext(){return this.position<this.length-1}getByte(){var t=this.view.getUint8(this.position,this.littleEndian);return this.position++,t}getShort(){var t=this.view.getInt16(this.position,this.littleEndian);return this.position+=2,t}getUShort(){var t=this.view.getUint16(this.position,this.littleEndian);return this.position+=2,t}getInt(){var t=this.view.getInt32(this.position,this.littleEndian);return this.position+=4,t}getUInt(){var t=this.view.getUint32(this.position,this.littleEndian);return this.position+=4,t}getLong(){var t=[];t[0]=this.view.getUint8(this.position),t[1]=this.view.getUint8(this.position+1),t[2]=this.view.getUint8(this.position+2),t[3]=this.view.getUint8(this.position+3),t[4]=this.view.getUint8(this.position+4),t[5]=this.view.getUint8(this.position+5),t[6]=this.view.getUint8(this.position+6),t[7]=this.view.getUint8(this.position+7);var e=0;if(this.littleEndian)for(var i=t.length-1;i>=0;i--)e=256*e+t[i];else for(i=0;i<t.length;i++)e=256*e+t[i];return this.position+=8,e}getString(t){for(var e,i="";0!=(e=this.view.getUint8(this.position++))&&(i+=String.fromCharCode(e),!t||i.length!=t););return i}getFixedLengthString(t){var e,i,r="";for(e=0;e<t;e++)(i=this.view.getUint8(this.position++))>0&&(r+=String.fromCharCode(i));return r}getFixedLengthTrimmedString(t){var e,i,r="";for(e=0;e<t;e++)(i=this.view.getUint8(this.position++))>32&&(r+=String.fromCharCode(i));return r}getFloat(){var t=this.view.getFloat32(this.position,this.littleEndian);return this.position+=4,t}getDouble(){var t=this.view.getFloat64(this.position,this.littleEndian);return this.position+=8,t}skip(t){return this.position+=t,this.position}getVPointer(){var t=this.position,e=this.view.getUint8(t+1)<<8|this.view.getUint8(t),i=4294967296*(255&this.view.getUint8(t+6))+16777216*(255&this.view.getUint8(t+5))+65536*(255&this.view.getUint8(t+4))+256*(255&this.view.getUint8(t+3))+(255&this.view.getUint8(t+2));return this.position+=8,new x(i,e)}}class x{constructor(t,e){this.block=t,this.offset=e}isLessThan(t){return this.block<t.block||this.block===t.block&&this.offset<t.offset}isGreaterThan(t){return this.block>t.block||this.block===t.block&&this.offset>t.offset}print(){return this.block+":"+this.offset}}class _{constructor(t){t?(this.basesCovered=t.getLong(),this.minVal=t.getDouble(),this.maxVal=t.getDouble(),this.sumData=t.getDouble(),this.sumSquares=t.getDouble(),this.computeStats()):(this.basesCovered=0,this.minVal=0,this.maxVal=0,this.sumData=0,this.sumSquares=0,this.mean=0,this.stddev=0)}computeStats(){var t=this.basesCovered;if(t>0){this.mean=this.sumData/t,this.stddev=Math.sqrt(this.sumSquares/(t-1));this.minVal<0&&(this.mean,this.stddev),this.maxVal>0&&(this.mean,this.stddev);this.defaultRange={min:0,max:this.mean+3*this.stddev}}}updateStats(t){this.basesCovered+=t.count,this.sumData+=status.sumData,this.sumSquares+=sumSquares,this.minVal=MIN(_minVal,min),this.maxVal=MAX(_maxVal,max),computeStats.call(this)}}class k{constructor(t,e){var i=null;this.header={},this.header.magic=t.getInt(),this.header.blockSize=t.getInt(),this.header.keySize=t.getInt(),this.header.valSize=t.getInt(),this.header.itemCount=t.getLong(),this.header.reserved=t.getLong(),this.dictionary={},function t(r,n,a,s){n>=0&&(r.position=n);var o,h,l,f,c,u,d=r.getByte(),p=(r.getByte(),r.getUShort());if(1==d)for(o=0;o<p;o++)h=r.getFixedLengthTrimmedString(a),l=r.getInt(),r.getInt(),i&&(h=i.getChromosomeName(h)),s[h]=l;else for(o=0;o<p;o++)h=r.getFixedLengthTrimmedString(a),f=r.getLong(),c=f-e,u=r.position,t(r,c,a,s),r.position=u}(t,-1,this.header.keySize,this.dictionary);this.header.keySize}}}).call(this,i(6))},function(t,e,i){"use strict";var r=i(8),n=i(0),a=i(3),s=(i(1),i(2));let o=function(t,e,i){return new Promise(function(r,o){n.a.loadArrayBuffer(t,{headers:e.headers,withCredentials:e.withCredentials}).then(function(e){var n,o,l,f,c,u,d,p,g,m,b,w,y,v,x=[],_=Number.MAX_VALUE,k=0;if(e){if(i)e=new s.a.Gunzip(new Uint8Array(e)).decompress().buffer;if(!(21578050===(n=(c=new a.b(new DataView(e))).getInt())||i&&21578324===n))throw new Error(t+" is not a "+(i?"tabix":"bai")+" file");if(f=c.getInt(),i){c.getInt(),c.getInt(),c.getInt(),c.getInt(),c.getInt(),c.getInt(),c.getInt();for(v={},w=0;w<f;w++){var S=c.getString();null,v[S]=w}}for(y=0;y<f;++y){for(u={},d=[],o=c.getInt(),b=0;b<o;++b)if(37450==(p=c.getInt())){I=c.getInt(),g=c.getVPointer(),m=c.getVPointer();c.getLong(),c.getLong()}else{u[p]=[];var I=c.getInt();for(w=0;w<I;w++)g=c.getVPointer(),m=c.getVPointer(),g&&m&&(g.block<_&&(_=g.block),m.block>k&&(k=m.block),u[p].push([g,m]))}for(l=c.getInt(),w=0;w<l;w++)g=c.getVPointer(),d.push(g);o>0&&(x[y]={binIndex:u,linearIndex:d})}r(new h(x,_,k,v,i))}else r(null)}).catch(o)})};class h{constructor(t,e,i,r,n){this.firstAlignmentBlock=e,this.indices=t,this.lastAlignmentBlock=i,this.sequenceIndexMap=r,this.tabix=n}blocksForRange(t,e,i){var r,n,a,s,o,l,f,c,u=this.indices[t];if(u){for(r=h.reg2bins(e,i),n=[],r.forEach(function(t){if(u.binIndex[t])for(var e=u.binIndex[t],i=e.length,r=0;r<i;++r){var a=e[r][0],s=e[r][1];n.push({minv:a,maxv:s,bin:t})}}),a=u.linearIndex.length,s=null,o=Math.min(e>>14,a-1),l=Math.min(i>>14,a-1),c=o;c<=l;++c)(f=u.linearIndex[c])&&(s&&!f.isLessThan(s)||(s=f));return function(t,e){var i=[],r=null;return 0===t.length?t:(t.sort(function(t,e){var i=t.minv.block-e.minv.block;return 0!=i?i:t.minv.offset-e.minv.offset}),t.forEach(function(t){e&&!t.maxv.isGreaterThan(e)||(null===r?(i.push(t),r=t):t.minv.block-r.maxv.block<65e3?t.maxv.isGreaterThan(r.maxv)&&(r.maxv=t.maxv):(i.push(t),r=t))}),i)}(n,s)}return[]}static reg2bins(t,e){var i,r=[];for(e>=1<<29&&(e=1<<29),--e,r.push(0),i=1+(t>>26);i<=1+(e>>26);++i)r.push(i);for(i=9+(t>>23);i<=9+(e>>23);++i)r.push(i);for(i=73+(t>>20);i<=73+(e>>20);++i)r.push(i);for(i=585+(t>>17);i<=585+(e>>17);++i)r.push(i);for(i=4681+(t>>14);i<=4681+(e>>14);++i)r.push(i);return r}}class l{constructor(t,e,i,r){this.chr=t,this.bpStart=e,this.length=i-e,this.parent=r,this.coverage=new Array(this.length),this.maximum=0}incCounts(t){var e=this;function i(i){var r,n,a,s,o;for(a=i.start-e.bpStart,s=0;s<i.len;a++,s++)e.coverage[a]||(e.coverage[a]=new f),n=i.seq.charAt(s),r=t.strand?"pos"+n:"neg"+n,o=i.qual[s],e.coverage[a][r]+=1,e.coverage[a]["qual"+n]+=o,e.coverage[a].total+=1,e.coverage[a].qual+=o,e.maximum=Math.max(e.coverage[a].total,e.maximum)}void 0===t.blocks?i(t):t.blocks.forEach(function(t){i(t)})}}l.threshold=.2,l.qualityWeight=!0;class f{constructor(){this.posA=0,this.negA=0,this.posT=0,this.negT=0,this.posC=0,this.negC=0,this.posG=0,this.negG=0,this.posN=0,this.negN=0,this.pos=0,this.neg=0,this.qualA=0,this.qualT=0,this.qualC=0,this.qualG=0,this.qualN=0,this.qual=0,this.total=0}isMismatch(t){var e,i=this,r=l.threshold*(l.qualityWeight&&this.qual?this.qual:this.total);return e=0,["A","T","C","G"].forEach(function(r){r!==t&&(e+=l.qualityWeight&&i.qual?i["qual"+r]:i["pos"+r]+i["neg"+r])}),e>=r}}i.d(e,"b",function(){return T}),i.d(e,"a",function(){return d}),i.d(e,"c",function(){return u});class c{constructor(t){this.config=t||{}}getFileHeader(){return this.is_indexed=!0,new Promise(function(t,e){t()})}getFeatures(t,e,i,r,n){if(this.is_indexed)return this._getFeatures(t,e,i,r,n);var a=this;return new Promise(function(s,o){a.getFileHeader().then(function(){a._getFeatures(t,e,i,r,n).then(function(t){s(t)}).catch(o)}).catch(o)})}_getFeatures(t,e,i,r,n){0===e&&(e=1);var a=this;return a.time=Date.now(),new Promise(function(s,o){a.featureCache&&t!==a.featureCache.range.chr&&(a.featureCache=null);var h=new A(t,e,i),l=a.featureCache,f=a.config.maxRows||500;let u=!1;if(l?void 0!==l.range&&(u=l.range.rangesToGet(h)):u={all:[e,i]},u){let l=[],d=[];for(let e in u){let i=u[e];l.push(a.retrieveFeatures(t,i[0],i[1],r,n)),d.push([e,u[e]])}Promise.all(l).then(function(r){let n=[];a.featureCache&&(n=a.featureCache.allFeatures());let o=0;for(let t of r){if(null===t&&(t=[]),"left"===d[o][0]){let e=d[o][1][1],i=0;for(let r=t.length-1;r>=0&&!(t[r].end<e);r--)i++;0!==i&&t.splice(-i)}if("right"===d[o][0]){let e=d[o][1][0],i=0;for(i=0;i<t.length&&!(t[i].start>e);i++);0!==i&&t.splice(0,i)}o++,n=n.concat(t)}let l=a.featureCache?a.featureCache.range:h;a.featureCache=new y(n,l),c.packFeatures(n,f),s(a.featureCache.queryFeatures(t,e,i))}).catch(function(t){o(t)})}else s(a.featureCache.queryFeatures(t,e,i))})}static packFeatures(t,e){if(null!=t&&0!==t.length){var i={},r=[];t.forEach(function(t){var e=t.chr,n=i[e];n||(n=[],i[e]=n,r.push(e)),n.push(t)}),r.forEach(function(t){!function(t,e){var i=[];t.sort(function(t,e){return t.start-e.start}),i.push(-1e3),t.forEach(function(t){var r,n=Math.min(i.length,e),a=t.start;for(r=0;r<n;r++)if(a>=i[r])return t.row=r,void(i[r]=t.end);t.row=r,i[r]=t.end})}(i[t],e)})}}}class u extends c{constructor(t,e){super(t),this.reader=new g(t,e)}retrieveFeatures(t,e,i){return this.reader.readFeatures(t,e,i)}getFileHeader(){var t=this;return new Promise(function(e,i){t.reader.readHeader().then(function(){t.is_indexed=!0,e()}).catch(i)})}}class d extends c{constructor(t,e){t.sourceType="gtex",super(t),this.header=!0,this.feature_source=new a.a(t,e)}retrieveFeatures(t,e,i,r,n){return this.feature_source.getFeatures(t,e,i,!1,n)}}const p=65536;class g{constructor(t,e){if(this.config=t||{},t.localFile)this.localFile=t.localFile,this.filename=t.localFile.name;else{this.url=t.url,this.indexURL=t.indexURL,this.headURL=t.headURL||this.filename;var i=r.a.parseUri(t.url);this.filename=i.file,this.path=i.path}this.format=t.format,this.parser=this.getParser(this.format,e)}getParser(t,e){switch(t){case"vcf":return new VcfParser;case"seg":return new SegParser;default:return new w(t,e,this.config)}}isIndexable(){var t=this.config.indexURL,e=this.type,i=this.config.indexed;return t||"wig"!=e&&0!=i}loadIndex(){var t=this.indexURL;return this.filename.endsWith(".gz")?(t||(t=this.url+".tbi"),o(t,this.config,!0)):(t||(t=this.url+".idx"),loadTribbleIndex(t,this.config))}loadFeaturesNoIndex(){var t=this;return new Promise(function(e,i){var r=t.parser,a={headers:t.config.headers,withCredentials:t.config.withCredentials};function s(i){t.header=r.parseHeader(i),t.header instanceof String&&t.header.startsWith("##gff-version 3")&&(t.format="gff3"),e(r.parseFeatures(i))}t.localFile?n.a.loadStringFromFile(t.localFile,a).then(s).catch(i):n.a.loadString(t.url,a).then(s).catch(i)})}loadFeaturesWithIndex(t,e,i){var r=this;return new Promise(function(a,s){var o,h=r.index,l=h&&h.tabix?h.sequenceIndexMap[t]:t,f=[];(o=h.blocksForRange(l,e,i))&&0!==o.length?(o.forEach(function(a){f.push(new Promise(function(s,o){var l,f=a.minv.block,c=a.minv.offset,u=a.maxv.block+(h.tabix?p:0),d={headers:r.config.headers,range:{start:f,size:u-f+1},withCredentials:r.config.withCredentials};l=function(a){var o,l;o=h.tabix?n.a.arrayBufferToString(Object(n.b)(a)):a,l=c?o.slice(c):o;var f=r.parser.parseFeatures(l,t,e,i);s(f)},r.localFile?n.a.loadStringFromFile(r.localFile,d).then(l).catch(o):h.tabix?n.a.loadArrayBuffer(r.url,d).then(l).catch(o):n.a.loadString(r.url,d).then(l).catch(o)}))}),Promise.all(f).then(function(t){var e,i;if(1===t.length)i=t[0];else{for(i=t[0],e=1;e<t.length;e++)i=i.concat(t[e]);i.sort(function(t,e){return t.start-e.start})}a(i)}).catch(s)):a(null)})}getIndex(){var t=this,e=this.isIndexable();return new Promise(function(i,r){void 0===t.indexed&&e?t.loadIndex().then(function(e){e?(t.index=e,t.indexed=!0):t.indexed=!1,i(t.index)}).catch(r):i(t.index)})}readHeader(){var t=this;return new Promise(function(e,i){t.header?e(t.header):t.getIndex().then(function(r){if(r){var a={headers:t.config.headers,bgz:r.tabix,range:{start:0,size:65e3},withCredentials:t.config.withCredentials},s=function(i){t.header=t.parser.parseHeader(i),e(t.header)};t.localFile?n.a.loadStringFromFile(t.localFile,a).then(s):n.a.loadString(t.url,a).then(s).catch(i)}else t.loadFeaturesNoIndex(void 0).then(function(i){var r=t.header||{};r.features=i,e(r)}).catch(error)}).catch(i)})}readFeatures(t,e,i){var r=this;return new Promise(function(n,a){function s(t){n(t)}r.index?r.loadFeaturesWithIndex(t,e,i).then(s).catch(a):r.loadFeaturesNoIndex().then(s)})}}const m=Number.MAX_VALUE,b=["Name","gene_name","gene","gene_id","alias","locus"];class w{constructor(t,e,i){this.format=t,this.nameField=i?i.nameField:void 0,this.skipRows=0,e?(this.delimiter=/\s+/,this.decode=function(t,i){let r={chr:t[0],start:parseInt(t[1]),end:parseInt(t[2])};return e(t.slice(3),r),r}):"generic"===i.decode_function?this.decode=function(t,e){let i={chr:t[0],start:parseInt(t[1]),end:parseInt(t[2])};return i.data=t.slice(3),i}:(this.decode=w.decodeBed,this.delimiter=/\s+/)}parseHeader(t){var e,i,r,n=t.split("\n"),a=n.length;for(i=0;i<a;i++){if(!((e=n[i]).startsWith("track")||e.startsWith("#")||e.startsWith("browser"))){r={};break}e.startsWith("track")?r=this.parseTrackLine(e):e.startsWith("##gff-version 3")&&(this.format="gff3",r||(r={}),r.format="gff3")}return r}parseFeatures(t,e,i,r){if(!t)return null;var n,a,s,o,h,l,f=t.split("\n"),c=f.length,u=[],d=0,p=(this.decode,this.format),g=this.delimiter||"\t";for(h=this.skipRows;h<c;h++)if(!((o=f[h]).startsWith("track")||o.startsWith("#")||o.startsWith("browser")))if("wig"===p&&o.startsWith("fixedStep"))n=this.parseFixedStep(o);else if("wig"===p&&o.startsWith("variableStep"))n=this.parseVariableStep(o);else if(!((s=f[h].split(g)).length<1||"wig"!==p&&s.length<3))if(a=this.decode(s,n)){if(a.chr!==e||a.end<i||a.start>r)continue;u.length<m?u.push(a):(l=Math.floor(Math.random()*d))<m&&(u[l]=a),d++}else console.log(null);return u}static parseFixedStep(t){var e=t.split(/\s+/);return{format:"fixedStep",chrom:e[1].split("=")[1],start:parseInt(e[2].split("=")[1],10),step:parseInt(e[3].split("=")[1],10),span:e.length>4?parseInt(e[4].split("=")[1],10):1,index:0}}static parseVariableStep(t){var e=t.split(/\s+/);return{format:"variableStep",chrom:e[1].split("=")[1],span:e.length>2?parseInt(e[2].split("=")[1],10):1}}static parseTrackLine(t){var e,i,r,n={},a=t.split(/(?:")([^"]+)(?:")|([^\s"]+)(?=\s+|$)/g),s=[];for(e=1;e<a.length;e++)a[e]&&0!==a[e].trim().length&&((i=a[e].trim()).endsWith("=")>0?r=i:r?(s.push(r+i),r=void 0):s.push(i));return s.forEach(function(t){if(t){var e=t.split("=",2);2==e.length&&(n[e[0]]=e[1])}}),n}static decodeBed(t,e){var i,r,n,a,s,o,h,l,f,c,u,d,p,g;if(t.length<3)return null;if(i=t[0],r=parseInt(t[1]),n=t.length>2?parseInt(t[2]):r+1,d={chr:i,start:r,end:n,score:1e3},t.length>3){h=(o=t[3].replace(/"/g,"")).split(";");for(var m=0;m<h.length;m++){var b=h[m].split("=");"gene_id"==b[0]&&(a=b[1]),"gene_name"==b[0]&&(s=b[1])}d.id=a||o,d.name=s||o}if(t.length>4&&(d.score=parseFloat(t[4])),t.length>5&&(d.strand=t[5]),t.length>6&&(d.cdStart=parseInt(t[6])),t.length>7&&(d.cdEnd=parseInt(t[7])),t.length>8&&"."!==t[8]&&"0"!==t[8]&&(d.color=igv.createColorString(t[8])),t.length>11){l=parseInt(t[9]),f=t[10].split(","),c=t[11].split(","),u=[];for(m=0;m<l;m++){var w={start:p=r+parseInt(c[m]),end:g=p+parseInt(f[m])};(d.cdStart>g||d.cdEnd<d.cdStart)&&(w.utr=!0),d.cdStart>=p&&d.cdStart<=g&&(w.cdStart=d.cdStart),d.cdEnd>=p&&d.cdEnd<=g&&(w.cdEnd=d.cdEnd),u.push(w)}d.exons=u}return d.popupData=function(){var t=[];return d.name&&t.push({name:"Name",value:d.name}),"+"!==d.strand&&"-"!==d.strand||t.push({name:"Strand",value:d.strand}),t},d}static decodeRefflat(t,e){if(t.length<10)return null;for(var i={chr:t[2],start:parseInt(t[4]),end:parseInt(t[5]),id:t[1],name:t[0],strand:t[3],cdStart:parseInt(t[6]),cdEnd:parseInt(t[7])},r=parseInt(t[8]),n=t[9].split(","),a=t[10].split(","),s=[],o=0;o<r;o++)s.push({start:parseInt(n[o]),end:parseInt(a[o])});return i.exons=s,i.popupData=function(){return[{name:"Name",value:i.name}]},i}static decodePeak(t,e){var i,r,n,a,s,o,h,l,f;return t.length<9?null:(i=t[0],r=parseInt(t[1]),n=parseInt(t[2]),s=t[3],o=parseFloat(t[4]),a=t[5].trim(),l=parseFloat(t[6]),f=parseFloat(t[7]),h=parseFloat(t[8]),0===o&&(o=l),{chr:i,start:r,end:n,name:s,score:o,strand:a,signal:l,pValue:f,qValue:h})}static decodeBedGraph(t,e){return t.length<3?null:{chr:t[0],start:parseInt(t[1]),end:parseInt(t[2]),value:parseFloat(t[3])}}static decodeWig(t,e){var i,r,n;return"fixedStep"===e.format?(r=(i=e.index*e.step+e.start)+e.span,n=parseFloat(t[0]),++e.index,isNaN(n)?null:{chr:e.chrom,start:i,end:r,value:n}):"variableStep"===e.format?t.length<2?null:(r=(i=parseInt(t[0],10))+e.span,n=parseFloat(t[1]),isNaN(n)?null:{chr:e.chrom,start:i,end:r,value:n}):decodeBedGraph(t)}static decodeAneu(t,e){var i,r,n,a;return t.length<4?null:(i=t[1],r=parseInt(t[2]),n=t.length>3?parseInt(t[3]):r+1,a={chr:i,start:r,end:n},t.length>4&&(a.score=parseFloat(t[4]),a.value=a.score),a.popupData=function(){return[{name:"Name",value:a.name}]},a)}static decodeFusionJuncSpan(t,e){var i=t[0],r=t[1],n=parseInt(t[2]),a=parseInt(t[3]),s=parseInt(t[4]),o=parseInt(t[5]),h=t[6],l={chr:i,name:r,junction_left:n,junction_right:a,num_junction_reads:s,num_spanning_frags:o,spanning_frag_coords:[],start:-1,end:-1},f=n,c=a;if(o>0)for(var u=h.split(","),d=0;d<u.length;d++){var p=u[d].split("-"),g=p[0],m=p[1];g<f&&(f=g),m>c&&(c=m),l.spanning_frag_coords.push({left:g,right:m})}return l.start=f,l.end=c,l.popupData=function(){return[{name:"Name",value:l.name}]},l}static decodeGtexGWAS(t,e){return t.length<8?null:{chr:t[0],start:parseInt(t[1])-1,end:parseInt(t[3].split(":")[1]),pvalue:parseFloat(t[5])}}static decodeGFF(t,e){var i,r,n,a,s,o,h,l,f,c,u,d,p=this.format;if(t.length<9)return null;i=t[0],s=t[2],r=parseInt(t[3])-1,n=parseInt(t[4]),o="."===t[5]?0:parseFloat(t[5]),a=t[6],"."===t[7]||parseInt(t[7]),h=t[8];var g="gff3"===p?"=":/\s+/,m={};if(h.split(";").forEach(function(t){var e,i,r=t.trim().split(g,2);2==r.length&&(e=r[0].trim(),(i=r[1].trim()).startsWith('"')&&i.endsWith('"')&&(i=i.substr(1,i.length-2)),"ID"===r[0]?l=r[1]:"Parent"===r[0]?f=r[1]:"color"===r[0].toLowerCase()?c=igv.createColorString(r[1]):"transcript_id"===r[0]&&(l=r[1]),m[e]=i)}),this.nameField)u=m[this.nameField];else for(d=0;d<b.length;d++)if(m.hasOwnProperty(b[d])){this.nameField=b[d],u=m[this.nameField];break}return{id:l,parent:f,name:u,type:s,chr:i,start:r,end:n,score:o,strand:a,color:c,attributeString:h,popupData:function(){var t,e,i=[];return this.attributeString.split(";").forEach(function(r){var n=r.trim().split(g,2);2===n.length&&void 0!==n[1]&&(t=n[0].trim(),(e=n[1].trim()).startsWith('"')&&e.endsWith('"')&&(e=e.substr(1,e.length-2)),i.push({name:t,value:e}))}),i}}}decodeCustom(t,e){var i,r,n,a,s=this.format,o=s.coords||0;return t.length<3?null:(r=t[s.chr],n=parseInt(t[s.start])-o,a=void 0!==s.end?parseInt(t[s.end]):n+1,i={chr:r,start:n,end:a},s.fields&&s.fields.forEach(function(e,r){r!=s.chr&&r!=s.start&&r!=s.end&&(i[e]=t[r])}),i)}}class y{constructor(t,e){this.treeMap=y.buildTreeMap(t),this.range=e}queryFeatures(t,e,i){var r,n,a,s,o,h,l;return(h=this.treeMap[t])?0==(l=h.findOverlapping(e,i)).length?[]:(r=[],l.forEach(function(t){for(n=t.value,s=n.length,o=0;o<s&&!((a=n[o]).start>i);o++)a.end>=e&&r.push(a)}),r):[]}allFeatures(){var t=[],e=this.treeMap;if(e)for(var i in e){if(e.hasOwnProperty(i))e[i].mapIntervals(function(e){t=t.concat(e.value)})}return t}static buildTreeMap(t){var e={},i=[],r={};if(t){t.forEach(function(t){var r,n=t.chr;(r=e[n])||(i.push(n),r=[],e[n]=r),r.push(t)});for(let t=0;t<i.length;t++){let n=i[t];r[n]=y.buildIntervalTree(e[n])}}return r}static buildIntervalTree(t){var e,i,r,n,a,s,o,h;for(a=new k,o=t.length,s=Math.max(10,Math.round(o/100)),t.sort(function(t,e){return t.start===e.start?0:t.start>e.start?1:-1}),e=0;e<o;e+=s)i=Math.min(o,e+s),r=(h=t.slice(e,i))[0].start,n=r,h.forEach(function(t){n=Math.max(n,t.end)}),a.insert(r,n,h);return a}}const v=1,x=2;let _={};_.color=v,_.parent=_,_.left=_,_.right=_;class k{constructor(){this.root=_}insert(t,e,i){var r=new S(t,e,i),n=new I(r);for(this.treeInsert(n),n.color=x;n!=this.root&&n.parent.color==x;){var a;if(n.parent==n.parent.parent.left)(a=n.parent.parent.right).color==x?(n.parent.color=v,a.color=v,n.parent.parent.color=x,n=n.parent.parent):(n==n.parent.right&&(n=n.parent,this.leftRotate(n)),n.parent.color=v,n.parent.parent.color=x,this.rightRotate(n.parent.parent));else(a=n.parent.parent.left).color==x?(n.parent.color=v,a.color=v,n.parent.parent.color=x,n=n.parent.parent):(n==n.parent.left&&(n=n.parent,this.rightRotate(n)),n.parent.color=v,n.parent.parent.color=x,this.leftRotate(n.parent.parent))}this.root.color=v}findOverlapping(t,e){var i=new S(t,e,0);if(this.root===_)return[];var r=this.searchAll(i,this.root,[]);return r.length>1&&r.sort(function(t,e){return t.low-e.low}),r}logIntervals(){!function t(e,i){var r="";for(var n=0;n<i;n++)r+=" ";console.log(r+e.interval.low+" "+e.interval.high);i+=5;e.left!=_&&t(e.left,i);e.right!=_&&t(e.right,i)}(this.root,0)}mapIntervals(t){!function e(i){t(i.interval);i.left!=_&&e(i.left);i.right!=_&&e(i.right)}(this.root)}searchAll(t,e,i){return e.interval.overlaps(t)&&i.push(e.interval),e.left!=_&&e.left.max>=t.low&&this.searchAll(t,e.left,i),e.right!=_&&e.right.min<=t.high&&this.searchAll(t,e.right,i),i}leftRotate(t){var e=t.right;t.right=e.left,e.left!=_&&(e.left.parent=t),e.parent=t.parent,t.parent==_?this.root=e:t.parent.left==t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e,this.applyUpdate(t)}rightRotate(t){var e=t.left;t.left=e.right,e.right!=_&&(e.right.parent=t),e.parent=t.parent,t.parent==_?this.root=e:t.parent.right==t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e,this.applyUpdate(t)}treeInsert(t){for(var e=this.root,i=_;e!=_;)i=e,e=t.interval.low<=e.interval.low?e.left:e.right;t.parent=i,i==_?(this.root=t,t.left=t.right=_):t.interval.low<=i.interval.low?i.left=t:i.right=t,this.applyUpdate(t)}applyUpdate(t){for(;t!=_;){var e=t.left.max>t.right.max?t.left.max:t.right.max,i=t.interval.high;t.max=e>i?e:i;var r=t.left.min<t.right.min?t.left.min:t.right.min,n=t.interval.low;t.min=r<n?r:n,t=t.parent}}}class S{constructor(t,e,i){this.low=t,this.high=e,this.value=i}equals(t){return!!t&&(this==t||this.low==otherInterval.low&&this.high==otherInterval.high)}compareTo(t){return this.low<t.low?-1:this.low>t.low?1:this.high<t.high?-1:this.high>t.high?1:0}overlaps(t){try{return this.low<=t.high&&t.low<=this.high}catch(t){igv.presentAlert(t)}}}class I{constructor(t){this.parent=_,this.left=_,this.right=_,this.interval=t,this.color=x}}class A{constructor(t,e,i,r){this.chr=t,this.start=e,this.end=i,this.features=r}contains(t,e,i){return this.chr==t&&this.start<=e&&this.end>=i}containsRange(t){return this.chr===t.chr&&this.start<=t.start&&this.end>=t.end}rangesToGet(t){let e=!1,i={};return this.chr!==t.chr?(i.all=[t.start,t.end],e=!0,this.start=t.start,this.end=t.end):(t.start<this.start&&(i.left=[t.start,this.start],e=!0,this.start=t.start),t.end>this.end&&(i.right=[this.end,t.end],e=!0,this.end=t.end)),!!e&&i}}class T{constructor(t){this.file=t,this.indexed=!0,this.indexed&&(this.indexFile=this.file+".fai")}init(){var t=this;return t.indexed?new Promise(function(e,i){t.getIndex().then(function(i){var r=0;t.chromosomes={},t.chromosomeNames.forEach(function(e){var i=t.index[e].size;t.chromosomes[e]=new igv.Chromosome(e,r++,i)}),e()}).catch(i)}):t.loadAll()}getSequence(t,e,i){return this.indexed?this.getSequenceIndexed(t,e,i):getSequenceNonIndexed.this(t,e,i)}getSequenceIndexed(t,e,i){var r=this;return new Promise(function(n,a){var s=r.interval;if(s&&s.contains(t,e,i))n(c(s,e,i));else{var o=e,h=i;if(i-e<1e5){var l=i-e,f=Math.round(e+l/2);o=Math.max(0,f-5e4),h=f+5e4}r.readSequence(t,o,h).then(function(a){r.interval=new A(t,o,h,a),n(c(r.interval,e,i))}).catch(a)}function c(t,e,i){var r=e-t.start,n=i-e;return t.features?t.features.substr(r,n):null}})}getSequenceNonIndexed(t,e,i){var r=this;return new Promise(function(n,a){var s=r.sequences[t];s&&s.length>i&&n(s.substring(e,i))})}getIndex(){var t=this;return new Promise(function(e,i){t.index?e(t.index):n.a.load(t.indexFile,{}).then(function(i){var r=i.split("\n"),n=r.length,a=0;for(t.chromosomeNames=[],t.index={};a<n;){var s=r[a++].split("\t");if(5==s.length){var o=s[0],h={size:parseInt(s[1]),position:parseInt(s[2]),basesPerLine:parseInt(s[3]),bytesPerLine:parseInt(s[4])};t.chromosomeNames.push(o),t.index[o]=h}}e&&e(t.index)}).catch(i)})}loadAll(){var t=this;return new Promise(function(e,i){t.chromosomeNames=[],t.chromosomes={},t.sequences={},n.a.load(t.file,{withCredentials:t.withCredentials}).then(function(i){for(var r,n,a=i.splitLines(),s=a.length,o=0,h="",l=0;o<s;)(r=a[o++].trim()).startsWith("#")||0===r.length||(r.startsWith(">")?(h&&(t.chromosomeNames.push(n),t.sequences[n]=h,t.chromosomes[n]=new igv.Chromosome(n,l++,h.length)),n=r.substr(1).split("\\s+")[0],h=""):h+=r);e()})})}readSequence(t,e,i){var r=this;return new Promise(function(a,s){r.getIndex().then(function(){var o=r.index[t];if(o){var h=Math.max(0,e),l=Math.min(o.size,i),f=o.bytesPerLine,c=o.basesPerLine,u=o.position,d=f-c,p=Math.floor(h/c),g=Math.floor(l/c),m=h-p*c,b=u+p*f+m,w=u+g*f+(l-g*c)-1-b+1;w<=0&&a(null),n.a.load(r.file,{range:{start:b,size:w}}).then(function(t){var e,i="",r=0,n=t.length;for(m>0&&(e=Math.min(l-h,c-m),i+=t.substr(r,e),r+=e+d,e);r<n;)e=Math.min(c,n-r),i+=t.substr(r,e),r+=e+d,e;a(i)}).catch(s)}else console.log("No index entry for chr: "+t),r.interval=new A(t,e,i,null),a(null)}).catch(s)})}}},function(t,e){t.exports=require("xhr2")},function(t,e){t.exports=require("extend")},function(t,e){t.exports=require("fs")},function(t,e,i){"use strict";(function(t,r){i.d(e,"a",function(){return a});let n={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};class a{static addAlphaToRGB(t,e){return t.startsWith("rgb")?t.replace("rgb","rgba").replace(")",", "+e+")"):(console.log(t+" is not an rgb style string"),t)}static presentAlert(e,i){let r=t("<div>").css({position:"absolute","background-color":"white"}).attr("class","mlv-alert").appendTo(e);t("<div>").css({display:"flex","justify-content":"center"}).appendTo(r).append(t('<i class="fas fa-exclamation-circle"></i>').css({color:"red","font-size":"16px","text-align":"center"})),r.append(t("<div>"+i+"</div>").css({color:"red","font-size":"14px","text-align":"center"}));let n=Math.round(e.width()/2-r.width()/2),a=Math.round(e.height()/2-r.height()/2);r.css({left:n+"px",top:a+"px"})}static spinner(e){var i;return i=t('<i class="fa fa-lg fa-spinner fa-spin igv-spinner">').css({position:"absolute",top:"50%",left:"50%"}),e&&i.css("font-size",e),i[0]}static getSpinnerObjectWithParentElement(t){return t.find("div.igv-spinner-container")}static startSpinnerAtParentElement(t){t.children(".fa-spinner").show()}static stopSpinnerAtParentElement(t){t.children(".fa-spinner").hide()}static parseUri(t){for(var e=n,i=e.parser[e.strictMode?"strict":"loose"].exec(t),r={},a=14;a--;)r[e.key[a]]=i[a]||"";return r[e.q.name]={},r[e.key[12]].replace(e.q.parser,function(t,i,n){i&&(r[e.q.name][i]=n)}),r}static domElementRectAsString(t){return" x "+t.clientLeft+" y "+t.clientTop+" w "+t.clientWidth+" h "+t.clientHeight}static isNumber(t){return""!==t&&(void 0!==t&&(!isNaN(parseFloat(t))&&isFinite(t)))}static guid(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}static random(t,e){return Math.random()*(e-t)+t}static numberFormatter(t){var e=String(t).split(/[.,]/);return e[0].split("").reverse().reduce(function(t,e,i){return i%3==0?t+","+e:t+e}).split("").reverse().join("")+(e[1]?"."+e[1]:"")}static numberUnFormatter(t){return t.split(",").join().replace(",","","g")}static translateMouseCoordinates(e,i){var r=t.event.fix(e);return{x:r.pageX-t(i).offset().left,y:r.pageY-t(i).offset().top}}static formatPopoverText(t){var e='<table class="igv-popover-table">';return t.forEach(function(t){t.name?e+='<tr><td class="igv-popover-td"><div class="igv-popoverNameValue"><span class="igv-popoverName">'+t.name+'</span><span class="igv-popoverValue">'+t.value+"</span></div></td></tr>":e+="<tr><td>"+t.toString()+"</td></tr>"}),e+="</table>"}static throttle(t,e,i){var r,n;return e||(e=200),function(){var a=i||this,s=+new Date,o=arguments;r&&s<r+e?(clearTimeout(n),n=setTimeout(function(){r=s,t.apply(a,o)},e)):(r=s,t.apply(a,o))}}static splitStringRespectingQuotes(t,e){var i,r,n=[],a=t.length,s=0,o=!1;if(a>0)for(n[s]=t.charAt(0),i=1;i<a;i++)'"'===(r=t.charAt(i))?o=!o:o||r!==e?n[s]+=r:n[++s]="";return n}static addAjaxExtensions(){t.ajaxTransport("+binary",function(t,e,i){return{send:function(e,i){var n=new r,a=t.url,s=t.type;t.data;if(n.addEventListener("load",function(){var e={};e[t.dataType]=n.response,i(n.status,n.statusText,e,n.getAllResponseHeaders())}),n.open(s,a),n.responseType="arraybuffer",t.headers)for(var o in t.headers)t.headers.hasOwnProperty(o)&&n.setRequestHeader(o,t.headers[o])},abort:function(){i.abort()}}})}static isStringOrNumber(t){return!(!t.substring&&!t.toFixed)}static constrainBBox(t,e){var i,r,n={},a={};return a.left=a.top=0,a.right=e.outerWidth(),a.bottom=e.outerHeight(),r=t.offset(),n.left=r.left-e.offset().left,n.top=r.top-e.offset().top,n.right=n.left+t.outerWidth(),n.bottom=n.top+t.outerHeight(),(i=n.bottom-a.bottom)>0&&(r.top-=i,n.top-=i,n.bottom-=i,(i=n.top-a.top)<0&&(r.top-=i)),r}static log(t){igv.enableLogging&&console&&console.log&&console.log(t)}}}).call(this,i(13),i(5))},function(t,e,i){"use strict";(function(t){i.d(e,"a",function(){return a});var r=i(3),n=i(4);class a{constructor(t){this.config=t}_setFeatureSource(){}drawScale(t){}getConfig(){return t(!0,{},this.config)}setConfigAttribute(t,e){this.config[t]=e,"url"===t&&this._setFeatureSource()}getFeatureAt(t,e,i,r){return null}setConfig(t){this.config.url!==t.url?(this.config=t,this._setFeatureSource()):this._setFeatureSource()}getFeatures(t,e,i,r,n){return this.feature_source.getFeatures(t,e,i,r,n)}static calculateLabel(t){"string"!=typeof t&&(t=t[0]);let e=t.split("/"),i=e[e.length-1];return i=(e=i.split("."))[0]}addExtraControls(t,e){}static getTypeFromURL(t){let e={};return"string"!=typeof t?e:(t.endsWith("bw")?(e.type="bigwig",e.format="wig"):t.endsWith(".bed.gz")?(e.type="bed",e.format="feature"):t.endsWith(".bb")&&!e.type?(e.type="bigbed",e.format="feature"):t.endsWith(".fasta")?(e.type="fasta",e.format="sequence"):t.endsWith(".bam")&&(e.type="bam",e.format="alignment"),e)}static parseConfig(e){let i=t(!0,{},e);if(!i.type&&i.url){let t=a.getTypeFromURL(i.url);t.type&&(i.type=t.type,i.format=t.format)}return"bed"!==i.type&&"bigbed"!==i.type||(i.format="feature"),!i.short_label&&i.url&&(i.short_label=a.calculateLabel(i.url)),i.track_id||(i.track_id=i.url),"feature"===i.format&&(i.displayMode=i.displayMode||"COLLAPSED",i.labelDisplayMode="SLANT",i.squishedCallHeight=i.squishedCallHeight||30,i.expandedCallHeight=i.expandedCallHeight||15,i.featureHeight=i.featureHeight||12),"wig"!==i.format&&"bigwig"!==i.type||(i.scale||(i.scale="dynamic"),i.min_y||(i.min_y=0),i.max_y||(i.max_y=100),i.height||(i.height=100)),"bam"===i.type&&(i.featureHeight||(i.featureHeight=12)),i.height||(i.height=100),i.color||("bam"===i.type?i.color="#D3D3D3":i.color="black"),i.opacity||(i.opacity=1),i}static getTrack(t){t=a.parseConfig(t);let e=a.track_types[t.type];if(!e)throw new Error("Track type "+t.type+" not recognised");return new e.class(t)}}a.custom_tracks={},a.track_types={};class s extends a{constructor(t){t||(t={track_id:"ruler"+s.count,format:"ruler",short_label:"Ruler",type:"ruler"}),super(t),this.height=30,this.config.height=30,this.name="",this.disableButtons=!0,this.ignoreTrackMenu=!0,this.order=-Number.MAX_VALUE,s.count++}getFeatures(t,e,i){return new Promise(function(t,e){t([])})}drawFeatures(t){var e,i,r,n,a,o,h=t.context;e={textAlign:"center",font:"10px PT Sans",fillStyle:"rgba(64, 64, 64, 1)",strokeStyle:"rgba(64, 64, 64, 1)"},i=Math.floor(1100*t.bpPerPixel),n=(r=s.findSpacing(i)).majorTick,a=Math.floor(t.bpStart/n)-1,o=0;let l=t.top+this.height;for(f.setProperties(h,e);o<t.pixelWidth;){var c=Math.floor(a*n),u=2;o=Math.round((c-1-t.bpStart+.5)/t.bpPerPixel);var d=p(c/r.unitMultiplier,0)+" "+r.majorUnit;a%1==0&&f.fillText(h,d,o,l-15),f.strokeLine(h,o,l-10,o,l-u),a++}function p(t,e){var i=10;switch(e){case 0:i=1;break;case 1:i=10;break;case 2:i=100;break;default:i=1e3}var r=""+Math.abs(Math.round(t*i)/i);-1==r.indexOf(".")&&(r+=".");for(var n=r.substr(0,r.indexOf(".")),a=n-0,s=r.substr(r.indexOf("."));s.length-1<e;)s+="0";if("."==s&&(s=""),a>=1e3){var o=n.length;n=parseInt(""+a/1e3)+","+n.substring(o-3,o)}a>=1e6&&(o=n.length,n=parseInt(""+a/1e6)+","+n.substring(o-7,o));var h=n+s;return t<0&&(h="("+h+")"),h}return f.strokeLine(h,0,l-u,t.pixelWidth,l-u),l}static findSpacing(t){if(t<10)return new o(1,"",1);var e,i,r=Math.floor((e=t,i=Math.log(10),Math.log(e)/i)),n="",a=1;r>9&&(n="gb",a=1e9),r>6?(n="mb",a=1e6):r>3&&(n="kb",a=1e3);var s=t/Math.pow(10,r-1);return new o(s<25?Math.pow(10,r-1):Math.pow(10,r)/2,n,a)}}s.count=0,a.track_types.ruler={class:s,name:"Ruler"};class o{constructor(t,e,i){this.majorTick=t,this.majorUnit=e,this.unitMultiplier=i}}class h extends a{constructor(t){super(t),this._setFeatureSource(),this.filter_function=null,this.color_function=null}_setFeatureSource(){this.feature_source=new n.c(this.config)}setFilterFunction(t){this.filter_function=t}setColorFunction(t){this.color_function=t}getCurrentFeatures(t,e,i){return this.feature_source.featureCache.queryFeatures(t,e,i)}drawFeatures(t){let e=0;var i,r=t.features,n=t.context,a=t.bpPerPixel,s=t.bpStart,o=t.pixelWidth,h=(t.pixelHeight,s+o*a+1);let l=0;t.top&&(l=t.top),this.top=l;let f=this.config,c=0+o;this.config.squishedCallHeight=this.config.featureHeight+10,this.config.expandedCallHeight=this.config.featureHeight/2+2;let u=null;if(r.length>5e4&&(u=Math.round(r.length/5e4)+1),r){let t=this.config.opacity?this.config.opacity:1;n.globalAlpha=t;for(var d,p=0,g=r.length;p<g;p++){if(u&&p%u!=0)continue;if(d=r[p],this.filter_function&&!this.filter_function(d)){d.display=!1;continue}if(d.display=!0,d.end<s)continue;if(d.start>h)break;let t=this.calculateFeatureCoordinates(d,s,a),g=f.featureHeight;"SQUISHED"===f.displayMode&&void 0!=d.row?(g=f.featureHeight/2,i=f.expandedCallHeight*d.row+2):i="EXPANDED"===f.displayMode&&void 0!=d.row?f.squishedCallHeight*d.row+5:5,(i+=l)+g>e&&(e=i+g),t.py=i,t.h=g;let m={bpPerPixel:a,bpStart:s,pixelWidth:o};this.color_function&&(d.color=this.color_function(d)),this.renderFeature(d,t,n,m),this.renderFeatureLabel(n,d,t.px,t.px1,i,0,c)}n.globalAlpha=1}else console.log("No feature list");return this.bottom=e,"COLLAPSED"===this.config.displayMode&&(e+=25),e}renderFeatureLabel(t,e,i,r,n,a,s){let o=this.config;var h,l,c,u,d,p;r<a||i>s?(c=i,u=r):(c=Math.max(i,a),u=Math.min(r,s));let g=e.name;this.label_function&&(g=this.label_function(e)),u-c>t.measureText(g).width&&"SQUISHED"!=o.displayMode&&g&&(h={font:"10px PT Sans",textAlign:"center",fillStyle:o.color,strokeStyle:o.color},"COLLAPSED"===o.displayMode&&"SLANT"===o.labelDisplayMode&&(l={rotate:{angle:45}},delete h.textAlign),d=c+(u-c)/2,p=function(t,e){return e?t+o.featureHeight+14:t+o.featureHeight+7}(n,l),f.fillText(t,g,d,p,h,l))}calculateFeatureCoordinates(t,e,i){var r=Math.round((t.start-e)/i),n=Math.round((t.end-e)/i),a=n-r;return a<3&&(a=3,r-=1),{px:r,px1:n,pw:a}}renderFeature(t,e,i,r){var n,a,s,o,h,l,c,u,d,p,g,m=this.config.color;t.color&&(m=t.color),i.fillStyle=m,i.strokeStyle=m,p=(s=e.py+e.h/2)-(g=e.h/2)/2;let b=t.exons?t.exons.length:0;if(0==b)i.fillRect(e.px,e.py,e.pw,e.h);else{for(e.px=Math.max(e.px,0),e.px1=Math.min(e.px1,r.pixelWidth),f.strokeLine(i,e.px+1,s,e.px1-1,s),o="+"==t.strand?1:-1,a=e.px+10;a<e.px1;a+=20)f.strokeLine(i,a-2*o,s-2,a,s),f.strokeLine(i,a-2*o,s+2,a,s);for(n=0;n<b;n++)if(h=t.exons[n],l=Math.round((h.start-r.bpStart)/r.bpPerPixel),c=Math.round((h.end-r.bpStart)/r.bpPerPixel),d=Math.max(1,c-l),h.utr)i.fillRect(l,p,d,g);else if(h.cdStart&&(u=Math.round((h.cdStart-r.bpStart)/r.bpPerPixel),i.fillRect(l,p,u-l,g),d-=u-l,l=u),h.cdEnd&&(u=Math.round((h.cdEnd-r.bpStart)/r.bpPerPixel),i.fillRect(u,p,c-u,g),d-=c-u,c=u),i.fillRect(l,e.py,d,e.h),d>25){for(i.fillStyle="white",i.strokeStyle="white",a=l+10;a<c;a+=20)f.strokeLine(i,a-2*o,s-2,a,s),f.strokeLine(i,a-2*o,s+2,a,s);i.fillStyle=m,i.strokeStyle=m}}}getFeatureAt(t,e,i,r){let n=i.y-this.top;if(this.feature_source.featureCache){var a,s=2*r,o=this.feature_source.featureCache.queryFeatures(e,t-s,t+s);if("COLLAPSED"!=this.config.displayMode&&(a=Math.floor("SQUISHED"===this.config.displayMode?n/this.config.expandedCallHeight:n/this.config.squishedCallHeight)),o&&o.length>0){for(let e of o)if(e.end>=t-s&&e.start<=t+s&&(void 0===a||void 0===e.row||a===e.row)&&e.display)return e}}return null}}a.track_types.bed={class:h,name:"bed(tabix)"};a.track_types.bigbed={class:class extends h{constructor(t){super(t)}_setFeatureSource(){this.feature_source=new n.a(this.config)}},name:"BigBed"};class l extends a{constructor(t){t.format="wig",super(t),this._setFeatureSource()}_setFeatureSource(){this.feature_source=new r.a(this.config)}drawScale(t,e){if(this.config.scale_link_to&&this.config.group)return;let i=t,r=0;this.config.discrete&&(r=this.top,i=this.bottom);this.max_y,this.min_y;e.beginPath(),e.moveTo(0,r),e.lineTo(0,i),e.moveTo(0,r),e.lineTo(20,r),e.moveTo(0,i),e.lineTo(20,i),e.font="12px Arial",e.stroke(),e.textBaseline="top",e.fillStyle="black",e.fillText(this.max_y.toFixed(2),20,r),e.textBaseline="alphabetic",e.fillText(this.min_y,20,i)}drawFeatures(t){let e,i=this,r=t.features,n=i.config.color,a=t.context,s=t.bpPerPixel,o=t.bpStart,h=t.pixelWidth,l=t.pixelHeight,c=this.config.discrete?t.top:0,u=o+h*s+1;if(this.config.group?l=t.height:this.config.discrete&&(l=this.config.height),n||(n="black"),i.prev_coords={x:0,y:0},r){if(i.scale_link_to){let t=i.scale_link_to.config;t&&(i.config.scale=t.scale,i.max_y=i.scale_link_to.max_y,i.min_y=i.scale_link_to.min_y)}else if(i.set_scale)i.min_y=i.set_scale.min,i.max_y=i.set_scale.max;else if(void 0===i.max_y&&"automatic"===i.config.scale||"dynamic"===i.config.scale){var d=function(t){var e=0,i=-Number.MAX_VALUE;return t.forEach(function(t){e=Math.min(e,t.value),i=Math.max(i,t.value)}),{min:e,max:i}}(r);i.min_y=d.min,i.max_y=d.max}else"fixed"===i.config.scale&&(i.min_y=i.config.min_y,i.max_y=i.config.max_y);e=i.max_y-i.min_y;if(a.globalAlpha=this.config.opacity?this.config.opacity:1,i.is_line){let t=(1-i.config.value/e)*l;f.strokeLine(a,0,t,h,t,{strokeStyle:i.config.color,lineWidth:i.config.width?i.config.width:1})}else r.forEach(function(t,r,h){var d,p,g,m,b,w,y;if(t.end<o)return;if(t.start>u)return;t.end===t.start&&(t.start-=1);g=Math.floor((t.start-o)/s),y=Math.floor((t.end-o)/s),b=Math.max(0,y-g),v=i.min_y,x=i.max_y,v>0&&x<0||v<0&&x>0?t.value<0?(d=i.max_y/e,p=-t.value/e):(d=(i.max_y-t.value)/e,p=t.value/e):i.min_y<0?(d=0,p=-t.value/e):(d=1-(t.value-i.min_y)/e,p=(t.value+i.min_y)/e);var v,x;m=(m=d*l+c)<c?c:m,w=(w=p*l)>l?l:w,"line"===i.config.display?(i.prev_coords.x&&f.strokeLine(a,g,m,i.prev_coords.x,i.prev_coords.y,{strokeStyle:n,lineWidth:3}),i.prev_coords.x=g,i.prev_coords.y=m):f.fillRect(a,g,m,b,w,{fillStyle:n})});if(a.globalAlpha=1,i.config.threshold){let t=c+(1-i.config.threshold/e)*l;f.strokeLine(a,0,t,h,t,{strokeStyle:"black",lineWidth:1})}}if(this.top=c,this.bottom=c+l,this.config.discrete)return this.bottom;this.top=0,this.bottom=0}}a.track_types.bigwig={class:l,name:"BigWig"};a.track_types.line={class:class extends l{constructor(t){super(t),this.is_line=!0}getFeatures(t,e,i){return new Promise(function(t,e){t([])})}},name:"Line Track"};a.track_types.fasta={class:class extends a{constructor(t){super(t),this._setFeatureSource(t),this.sequenceType=t.sequenceType||"dna",this.height=15}_setFeatureSource(t){this.feature_source=new n.b(t.url)}getFeatures(t,e,i,r,n){let a=this;return new Promise(function(r,s){n.bpPerPixel>1?r(null):a.feature_source.getSequence(t,e,i).then(r).catch(s)})}drawFeatures(t){var e,i,r,n,a,s,o,h,l,c,u=t.features,d=t.context,p=t.bpPerPixel,g=t.bpStart,m=g+t.pixelWidth*p+1;let b=t.top;if(u)for(e=u.length,i=1/p,r=b+this.height/2,n=g;n<=m;n++)(a=n-g)<e&&(s=u[a],o=Math.floor(a*i),h=Math.floor((a+1)*i),l=Math.round((o+h)/2),(c=this.color?this.color:"dna"===this.sequenceType?f.nucleotideColors[s]:"rgb(0, 0, 150)")||(c="gray"),p>.15?f.fillRect(d,o,b,h-o,10,{fillStyle:c}):f.strokeText(d,s,l,r,{strokeStyle:c,font:"normal 10px Arial",textAlign:"center"}));return b+10}},name:"Fasta"};class f{static setProperties(t,e){for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];t[i]=r}}static strokeLine(t,e,i,r,n,a){e=Math.floor(e)+.5,i=Math.floor(i)+.5,r=Math.floor(r)+.5,n=Math.floor(n)+.5,t.save(),a&&f.setProperties(t,a),t.beginPath(),t.moveTo(e,i),t.lineTo(r,n),t.stroke(),t.restore()}static fillRect(t,e,i,r,n,a){e=Math.round(e),i=Math.round(i),a&&(t.save(),f.setProperties(t,a)),t.fillRect(e,i,r,n),a&&t.restore()}static fillPolygon(t,e,i,r){t.save(),r&&f.setProperties(t,r),f.doPath(t,e,i),t.fill(),t.restore()}static strokePolygon(t,e,i,r){t.save(),r&&f.setProperties(t,r),f.doPath(t,e,i),t.stroke(),t.restore()}static fillText(t,e,i,r,n,a){if(n&&(t.save(),f.setProperties(t,n)),t.save(),t.translate(i,r),a)for(var s in a){var o=a[s];"translate"==s&&t.translate(o.x,o.y),"rotate"==s&&t.rotate(o.angle*Math.PI/180)}t.fillText(e,0,0),t.restore(),n&&t.restore()}static strokeText(t,e,i,r,n,a){if(t.save(),n&&f.setProperties(t,n),t.translate(i,r),a)for(var s in a){var o=a[s];"translate"==s&&t.translate(o.x,o.y),"rotate"==s&&t.rotate(o.angle*Math.PI/180)}t.strokeText(e,0,0),t.restore()}static strokeCircle(t,e,i,r){t.beginPath(),t.arc(e,i,r,0,2*Math.PI),t.stroke()}static fillCircle(t,e,i,r){t.beginPath(),t.arc(e,i,r,0,2*Math.PI),t.fill()}static drawArrowhead(t,e,i,r,n){t.save(),r||(r=5),n&&(t.lineWidth=n),t.beginPath(),t.moveTo(e,i-r/2),t.lineTo(e,i+r/2),t.lineTo(e+r,i),t.lineTo(e,i-r/2),t.closePath(),t.fill(),t.restore()}static dashedLine(t,e,i,r,n,a,s){t.save(),e=Math.round(e),i=Math.round(i),r=Math.round(r),n=Math.round(n),a=Math.round(a),log("dashedLine"),s&&f.setProperties(t,s),void 0==a&&(a=2),t.moveTo(e,i);for(var o=r-e,h=n-i,l=Math.floor(Math.sqrt(o*o+h*h)/a),c=o/l,u=h/l,d=0;d++<l;)e+=c,i+=u,t[d%2==0?"moveTo":"lineTo"](e,i);t[d%2==0?"moveTo":"lineTo"](r,n),t.restore()}static doPath(t,e,i){var r,n=e.length;for(r=0;r<n;r++)e[r]=Math.round(e[r]),i[r]=Math.round(i[r]);for(t.beginPath(),t.moveTo(e[0],i[0]),r=1;r<n;r++)t.lineTo(e[r],i[r]);t.closePath()}}f.nucleotideColors={A:"green",T:"red",G:"black",C:"blue",a:"green",t:"red",c:"black",g:"blue"}}).call(this,i(6))},function(t,e,i){"use strict";i.r(e);var r=i(9);const n=i(7),a=i(12),s=i(11);var o=process.argv[2],h=i(7),l=h.readFileSync(o),f=JSON.parse(l);f.config.folder||(f.config.folder="images"),h.existsSync(f.config.folder)||h.mkdirSync(f.config.folder),new class{constructor(t,e){this.show_scale=!0,this.config=e||(e={}),this.config.height=this.config.height?this.config.height:200,this.config.width=this.config.width?this.config.width:300,this.config.type||(this.config.type="png"),this.c_type="png",this.stream="createPNGStream","svg"===e.type&&(this.c_type="svg"),"pdf"===e.type&&(this.stream="createPDFStream",this.c_type="pdf"),this.fixed_height_mode=!1,e.fixed_height_mode&&(this.fixed_height_mode=!0),this.tracks={},this.track_order=[];for(let e of t){let t=r.a.getTrack(e);this.fixed_height_mode&&(t.config.discrete=!0),this.tracks[t.config.track_id]=t,this.track_order.push(t.config.track_id)}for(let t of this.track_order){let e=this.tracks[t],i=e.config.scale_link_to;if(i){let t=this.tracks[i];t&&(e.scale_link_to=t)}}this.index=0}getTracksHeight(){let t=3,e={};for(let i in this.tracks){let r=this.tracks[i].config.group;if(r){if(e[r])continue;e[r]=!0}t+=this.tracks[i].config.height+3}return t}drawImages(){let t=this.config.images;if(this.index<t.length){let e=t[this.index],i=null;e.highlight&&(i={start:e.highlight[0],end:e.highlight[1],color:e.highlight[2]?e.highlight[3]:"blue"});let r=e.stub;r||(r=e.loc[0]+"_"+e.loc[1]+"_"+e.loc[2]);let n=s.resolve(this.config.folder,r+"."+this.config.type);this.drawImage(e.loc[0],e.loc[1],e.loc[2],n,i)}}drawImage(t,e,i,r,s){let o=(i-e)/this.config.width,h=this,l=this.fixed_height_mode?this.getTracksHeight():this.config.height;this.canvas=a.createCanvas(this.config.width,l,this.c_type),this.ctx=this.canvas.getContext("2d"),this.getAllFeatures(t,e,i,{pixelWidth:this.config.width,bpPerPixel:o}).then(function(t){if(t){var i={context:h.ctx,bpStart:e,bpPerPixel:o,pixelWidth:h.config.width,pixelHeight:l};let r=3;h.groups={},h.calculateMaxScale(t),h.ctx.clearRect(0,0,h.config.width,h.config.height),h.config.background_color&&"png"===h.config.type&&(h.ctx.fillStyle=h.config.background_color,h.ctx.fillRect(0,0,h.config.width,l));for(let e in t){let n=h.tracks[h.track_order[e]];i.features=t[e];let a=n.config.group,s=n.config.height;a?(h.groups[a]?h.groups[a].label_offset+=15:(h.groups[a]={top:r,height:n.config.height,label_offset:15},r+=n.config.height),i.top=h.groups[a].top,i.height=h.groups[a].height,s=i.height):i.top=r;let o=h.fixed_height_mode||n.config.discrete||a;console.log(o),o&&(h.ctx.save(),h.ctx.rect(0,i.top,i.pixelWidth,s),h.ctx.clip(),h.ctx.beginPath());let l=n.drawFeatures(i);if("ruler"!==n.config.type){h.ctx.fillStyle="black";let t=10;h.config.label_font_size?(h.ctx.font=h.config.label_font_size+"px Arial",t=h.config.label_font_size):h.ctx.font="10px Arial";let e=h.ctx.measureText(n.config.short_label).width+5,r=15;a&&(r=h.groups[a].label_offset,h.ctx.fillStyle=n.config.color,h.ctx.fillRect(h.config.width-(t+2),i.top+r-10,t,t),e+=t+2,h.ctx.fillStyle="black"),h.ctx.fillText(n.config.short_label,h.config.width-e,i.top+r)}o?(h.ctx.restore(),a||(r+=n.config.height+3)):l&&(r=l+3),h.show_scale&&(h.ctx.font="10px Arial",n.drawScale(i.pixelHeight,h.ctx))}if(s){let t=(s.start-i.bpStart)/i.bpPerPixel;t=t<0?0:t;let e=(s.end-s.start)/i.bpPerPixel;e=e>i.pixelWidth?i.pixelWidth:e,h.ctx.globalAlpha=.1,h.ctx.fillStyle=s.color,h.ctx.fillRect(t,0,e,i.pixelHeight),h.ctx.globalAlpha=1}}if("svg"===h.config.type)n.writeFileSync(r,h.canvas.toBuffer());else{const t=n.createWriteStream(r);h.canvas[h.stream]().pipe(t)}h.index++,h.drawImages()}).catch(function(t){console.log(t.toString()),h.index++,h.drawImages()})}autoScale(t,e,i){return t.forEach(function(t){e=Math.min(e,t.value),i=Math.max(i,t.value)}),{min:e,max:i}}calculateMaxScale(t){let e={};for(var i in t){let r=this.tracks[this.track_order[i]];r.set_scale=null;let n=r.config.group;if(n&&"fixed"!==r.config.scale&&!r.config.scale_link_to&&(r.config.scale_group=n),n=r.config.scale_group){let a=e[n];a?(a.features.push(t[i]),a.tracks.push(r)):(a={tracks:[r],features:[t[i]]},e[n]=a)}}for(let t in e){let i=e[t];if(!i.ignore){let t=0,e=-Number.MAX_VALUE,r=null;for(let n of i.features)t=(r=this.autoScale(n,t,e)).min,e=r.max;for(let t of i.tracks)t.set_scale=r}}}getAllFeatures(t,e,i,r){let n=[];for(let a of this.track_order){let s=this.tracks[a];n.push(s.getFeatures(t,e,i,!1,r))}return Promise.all(n)}}(f.tracks,f.config).drawImages()},function(t,e){t.exports=require("path")},function(t,e){t.exports=require("canvas")},function(t,e){t.exports=require("jquery")}]);